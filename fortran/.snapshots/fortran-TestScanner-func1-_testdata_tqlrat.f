(string) (len=7590) "COMMENT\t*** for old version, \"send otqlrat from eispack\"\nCOMMENT\t** From dana!moler Tue, 1 Sep 87 10:15:40 PDT\nCOMMENT\t** New TQLRAT\nIDENT\tSUBROUTINE\nIDENT\tTQLRAT\n(\t(\nIDENT\tN\n,\t,\nIDENT\tD\n,\t,\nIDENT\tE2\n,\t,\nIDENT\tIERR\n)\t)\nCOMMENT\tC\nIDENT\tINTEGER\nIDENT\tI\n,\t,\nIDENT\tJ\n,\t,\nIDENT\tL\n,\t,\nIDENT\tM\n,\t,\nIDENT\tN\n,\t,\nIDENT\tII\n,\t,\nIDENT\tL1\n,\t,\nIDENT\tMML\n,\t,\nIDENT\tIERR\nIDENT\tDOUBLE\nIDENT\tPRECISION\nIDENT\tD\n(\t(\nIDENT\tN\n)\t)\n,\t,\nIDENT\tE2\n(\t(\nIDENT\tN\n)\t)\nIDENT\tDOUBLE\nIDENT\tPRECISION\nIDENT\tB\n,\t,\nIDENT\tC\n,\t,\nIDENT\tF\n,\t,\nIDENT\tG\n,\t,\nIDENT\tH\n,\t,\nIDENT\tP\n,\t,\nIDENT\tR\n,\t,\nIDENT\tS\n,\t,\nIDENT\tT\n,\t,\nIDENT\tEPSLON\n,\t,\nIDENT\tPYTHAG\nCOMMENT\tC\nCOMMENT\tC     This subroutine is a translation of the Algol procedure tqlrat,\nCOMMENT\tC     Algorithm 464, Comm. ACM 16, 689(1973) by Reinsch.\nCOMMENT\tC\nCOMMENT\tC     This subroutine finds the eigenvalues of a symmetric\nCOMMENT\tC     tridiagonal matrix by the rational QL method.\nCOMMENT\tC\nCOMMENT\tC     On input\nCOMMENT\tC\nCOMMENT\tC        N is the order of the matrix.\nCOMMENT\tC\nCOMMENT\tC        D contains the diagonal elements of the input matrix.\nCOMMENT\tC\nCOMMENT\tC        E2 contains the squares of the subdiagonal elements of the\nCOMMENT\tC          input matrix in its last N-1 positions.  E2(1) is arbitrary.\nCOMMENT\tC\nCOMMENT\tC      On output\nCOMMENT\tC\nCOMMENT\tC        D contains the eigenvalues in ascending order.  If an\nCOMMENT\tC          error exit is made, the eigenvalues are correct and\nCOMMENT\tC          ordered for indices 1,2,...IERR-1, but may not be\nCOMMENT\tC          the smallest eigenvalues.\nCOMMENT\tC\nCOMMENT\tC        E2 has been destroyed.\nCOMMENT\tC\nCOMMENT\tC        IERR is set to\nCOMMENT\tC          zero       for normal return,\nCOMMENT\tC          J          if the J-th eigenvalue has not been\nCOMMENT\tC                     determined after 30 iterations.\nCOMMENT\tC\nCOMMENT\tC     Calls PYTHAG for  DSQRT(A*A + B*B) .\nCOMMENT\tC\nCOMMENT\tC     Questions and comments should be directed to Burton S. Garbow,\nCOMMENT\tC     Mathematics and Computer Science Div, Argonne National Laboratory\nCOMMENT\tC\nCOMMENT\tC     This version dated August 1987.\nCOMMENT\tC     Modified by C. Moler to fix underflow/overflow difficulties,\nCOMMENT\tC     especially on the VAX and other machines where epslon(1.0d0)**2\nCOMMENT\tC     nearly underflows.  See the loop involving statement 102 and\nCOMMENT\tC     the two statements just before statement 200.\nCOMMENT\tC\nCOMMENT\tC     ------------------------------------------------------------------\nCOMMENT\tC\nIDENT\tIERR\n=\t=\nIDENT\t0\nIDENT\tIF\n(\t(\nIDENT\tN\n.\t.\nIDENT\tEQ\n.\t.\nIDENT\t1\n)\t)\nIDENT\tGO\nIDENT\tTO\nIDENT\t1001\nCOMMENT\tC\nIDENT\tDO\nIDENT\t100\nIDENT\tI\n=\t=\nIDENT\t2\n,\t,\nIDENT\tN\nIDENT\t100\nIDENT\tE2\n(\t(\nIDENT\tI\n-\t-\nIDENT\t1\n)\t)\n=\t=\nIDENT\tE2\n(\t(\nIDENT\tI\n)\t)\nCOMMENT\tC\nIDENT\tF\n=\t=\nIDENT\t0\n.\t.\nIDENT\t0\nIDENT\tD0\nIDENT\tT\n=\t=\nIDENT\t0\n.\t.\nIDENT\t0\nIDENT\tD0\nIDENT\tE2\n(\t(\nIDENT\tN\n)\t)\n=\t=\nIDENT\t0\n.\t.\nIDENT\t0\nIDENT\tD0\nCOMMENT\tC\nIDENT\tDO\nIDENT\t290\nIDENT\tL\n=\t=\nIDENT\t1\n,\t,\nIDENT\tN\nIDENT\tJ\n=\t=\nIDENT\t0\nIDENT\tH\n=\t=\nIDENT\tDABS\n(\t(\nIDENT\tD\n(\t(\nIDENT\tL\n)\t)\n)\t)\n+\t+\nIDENT\tDSQRT\n(\t(\nIDENT\tE2\n(\t(\nIDENT\tL\n)\t)\n)\t)\nIDENT\tIF\n(\t(\nIDENT\tT\n.\t.\nIDENT\tGT\n.\t.\nIDENT\tH\n)\t)\nIDENT\tGO\nIDENT\tTO\nIDENT\t105\nIDENT\tT\n=\t=\nIDENT\tH\nIDENT\tB\n=\t=\nIDENT\tEPSLON\n(\t(\nIDENT\tT\n)\t)\nIDENT\tC\n=\t=\nIDENT\tB\n*\t* \nIDENT\tB\nIDENT\tif\n(\t(\nIDENT\tc\n.\t.\nIDENT\tne\n.\t.\nIDENT\t0\n.\t.\nIDENT\t0\nIDENT\td0\n)\t)\nIDENT\tgo\nIDENT\tto\nIDENT\t105\nCOMMENT\tC        Spliting tolerance underflowed.  Look for larger value.\nIDENT\tdo\nIDENT\t102\nIDENT\ti\n=\t=\nIDENT\tl\n,\t,\nIDENT\tn\nIDENT\th\n=\t=\nIDENT\tdabs\n(\t(\nIDENT\td\n(\t(\nIDENT\ti\n)\t)\n)\t)\n+\t+\nIDENT\tdsqrt\n(\t(\nIDENT\te2\n(\t(\nIDENT\ti\n)\t)\n)\t)\nIDENT\tif\n(\t(\nIDENT\th\n.\t.\nIDENT\tgt\n.\t.\nIDENT\tt\n)\t)\nIDENT\tt\n=\t=\nIDENT\th\nIDENT\t102\nIDENT\tcontinue\nIDENT\tb\n=\t=\nIDENT\tepslon\n(\t(\nIDENT\tt\n)\t)\nIDENT\tc\n=\t=\nIDENT\tb\n*\t* \nIDENT\tb\nCOMMENT\tC     .......... LOOK FOR SMALL SQUARED SUB-DIAGONAL ELEMENT ..........\nIDENT\t105\nIDENT\tDO\nIDENT\t110\nIDENT\tM\n=\t=\nIDENT\tL\n,\t,\nIDENT\tN\nIDENT\tIF\n(\t(\nIDENT\tE2\n(\t(\nIDENT\tM\n)\t)\n.\t.\nIDENT\tLE\n.\t.\nIDENT\tC\n)\t)\nIDENT\tGO\nIDENT\tTO\nIDENT\t120\nCOMMENT\tC     .......... E2(N) IS ALWAYS ZERO, SO THERE IS NO EXIT\nCOMMENT\tC                THROUGH THE BOTTOM OF THE LOOP ..........\nIDENT\t110\nIDENT\tCONTINUE\nCOMMENT\tC\nIDENT\t120\nIDENT\tIF\n(\t(\nIDENT\tM\n.\t.\nIDENT\tEQ\n.\t.\nIDENT\tL\n)\t)\nIDENT\tGO\nIDENT\tTO\nIDENT\t210\nIDENT\t130\nIDENT\tIF\n(\t(\nIDENT\tJ\n.\t.\nIDENT\tEQ\n.\t.\nIDENT\t30\n)\t)\nIDENT\tGO\nIDENT\tTO\nIDENT\t1000\nIDENT\tJ\n=\t=\nIDENT\tJ\n+\t+\nIDENT\t1\nCOMMENT\tC     .......... FORM SHIFT ..........\nIDENT\tL1\n=\t=\nIDENT\tL\n+\t+\nIDENT\t1\nIDENT\tS\n=\t=\nIDENT\tDSQRT\n(\t(\nIDENT\tE2\n(\t(\nIDENT\tL\n)\t)\n)\t)\nIDENT\tG\n=\t=\nIDENT\tD\n(\t(\nIDENT\tL\n)\t)\nIDENT\tP\n=\t=\n(\t(\nIDENT\tD\n(\t(\nIDENT\tL1\n)\t)\n-\t-\nIDENT\tG\n)\t)\n/\t/\n(\t(\nIDENT\t2\n.\t.\nIDENT\t0\nIDENT\tD0\n*\t* \nIDENT\tS\n)\t)\nIDENT\tR\n=\t=\nIDENT\tPYTHAG\n(\t(\nIDENT\tP\n,\t,\nIDENT\t1\n.\t.\nIDENT\t0\nIDENT\tD0\n)\t)\nIDENT\tD\n(\t(\nIDENT\tL\n)\t)\n=\t=\nIDENT\tS\n/\t/\n(\t(\nIDENT\tP\n+\t+\nIDENT\tDSIGN\n(\t(\nIDENT\tR\n,\t,\nIDENT\tP\n)\t)\n)\t)\nIDENT\tH\n=\t=\nIDENT\tG\n-\t-\nIDENT\tD\n(\t(\nIDENT\tL\n)\t)\nCOMMENT\tC\nIDENT\tDO\nIDENT\t140\nIDENT\tI\n=\t=\nIDENT\tL1\n,\t,\nIDENT\tN\nIDENT\t140\nIDENT\tD\n(\t(\nIDENT\tI\n)\t)\n=\t=\nIDENT\tD\n(\t(\nIDENT\tI\n)\t)\n-\t-\nIDENT\tH\nCOMMENT\tC\nIDENT\tF\n=\t=\nIDENT\tF\n+\t+\nIDENT\tH\nCOMMENT\tC     .......... RATIONAL QL TRANSFORMATION ..........\nIDENT\tG\n=\t=\nIDENT\tD\n(\t(\nIDENT\tM\n)\t)\nIDENT\tIF\n(\t(\nIDENT\tG\n.\t.\nIDENT\tEQ\n.\t.\nIDENT\t0\n.\t.\nIDENT\t0\nIDENT\tD0\n)\t)\nIDENT\tG\n=\t=\nIDENT\tB\nIDENT\tH\n=\t=\nIDENT\tG\nIDENT\tS\n=\t=\nIDENT\t0\n.\t.\nIDENT\t0\nIDENT\tD0\nIDENT\tMML\n=\t=\nIDENT\tM\n-\t-\nIDENT\tL\nCOMMENT\tC     .......... FOR I=M-1 STEP -1 UNTIL L DO -- ..........\nIDENT\tDO\nIDENT\t200\nIDENT\tII\n=\t=\nIDENT\t1\n,\t,\nIDENT\tMML\nIDENT\tI\n=\t=\nIDENT\tM\n-\t-\nIDENT\tII\nIDENT\tP\n=\t=\nIDENT\tG\n*\t* \nIDENT\tH\nIDENT\tR\n=\t=\nIDENT\tP\n+\t+\nIDENT\tE2\n(\t(\nIDENT\tI\n)\t)\nIDENT\tE2\n(\t(\nIDENT\tI\n+\t+\nIDENT\t1\n)\t)\n=\t=\nIDENT\tS\n*\t* \nIDENT\tR\nIDENT\tS\n=\t=\nIDENT\tE2\n(\t(\nIDENT\tI\n)\t)\n/\t/\nIDENT\tR\nIDENT\tD\n(\t(\nIDENT\tI\n+\t+\nIDENT\t1\n)\t)\n=\t=\nIDENT\tH\n+\t+\nIDENT\tS\n*\t* \n(\t(\nIDENT\tH\n+\t+\nIDENT\tD\n(\t(\nIDENT\tI\n)\t)\n)\t)\nIDENT\tG\n=\t=\nIDENT\tD\n(\t(\nIDENT\tI\n)\t)\n-\t-\nIDENT\tE2\n(\t(\nIDENT\tI\n)\t)\n/\t/\nIDENT\tG\nCOMMENT\tC           Avoid division by zero on next pass\nIDENT\tif\n(\t(\nIDENT\tg\n.\t.\nIDENT\teq\n.\t.\nIDENT\t0\n.\t.\nIDENT\t0\nIDENT\td0\n)\t)\nIDENT\tg\n=\t=\nIDENT\tepslon\n(\t(\nIDENT\td\n(\t(\nIDENT\ti\n)\t)\n)\t)\nIDENT\th\n=\t=\nIDENT\tg\n*\t* \n(\t(\nIDENT\tp\n/\t/\nIDENT\tr\n)\t)\nIDENT\t200\nIDENT\tCONTINUE\nCOMMENT\tC\nIDENT\tE2\n(\t(\nIDENT\tL\n)\t)\n=\t=\nIDENT\tS\n*\t* \nIDENT\tG\nIDENT\tD\n(\t(\nIDENT\tL\n)\t)\n=\t=\nIDENT\tH\nCOMMENT\tC     .......... GUARD AGAINST UNDERFLOW IN CONVERGENCE TEST ..........\nIDENT\tIF\n(\t(\nIDENT\tH\n.\t.\nIDENT\tEQ\n.\t.\nIDENT\t0\n.\t.\nIDENT\t0\nIDENT\tD0\n)\t)\nIDENT\tGO\nIDENT\tTO\nIDENT\t210\nIDENT\tIF\n(\t(\nIDENT\tDABS\n(\t(\nIDENT\tE2\n(\t(\nIDENT\tL\n)\t)\n)\t)\n.\t.\nIDENT\tLE\n.\t.\nIDENT\tDABS\n(\t(\nIDENT\tC\n/\t/\nIDENT\tH\n)\t)\n)\t)\nIDENT\tGO\nIDENT\tTO\nIDENT\t210\nIDENT\tE2\n(\t(\nIDENT\tL\n)\t)\n=\t=\nIDENT\tH\n*\t* \nIDENT\tE2\n(\t(\nIDENT\tL\n)\t)\nIDENT\tIF\n(\t(\nIDENT\tE2\n(\t(\nIDENT\tL\n)\t)\n.\t.\nIDENT\tNE\n.\t.\nIDENT\t0\n.\t.\nIDENT\t0\nIDENT\tD0\n)\t)\nIDENT\tGO\nIDENT\tTO\nIDENT\t130\nIDENT\t210\nIDENT\tP\n=\t=\nIDENT\tD\n(\t(\nIDENT\tL\n)\t)\n+\t+\nIDENT\tF\nCOMMENT\tC     .......... ORDER EIGENVALUES ..........\nIDENT\tIF\n(\t(\nIDENT\tL\n.\t.\nIDENT\tEQ\n.\t.\nIDENT\t1\n)\t)\nIDENT\tGO\nIDENT\tTO\nIDENT\t250\nCOMMENT\tC     .......... FOR I=L STEP -1 UNTIL 2 DO -- ..........\nIDENT\tDO\nIDENT\t230\nIDENT\tII\n=\t=\nIDENT\t2\n,\t,\nIDENT\tL\nIDENT\tI\n=\t=\nIDENT\tL\n+\t+\nIDENT\t2\n-\t-\nIDENT\tII\nIDENT\tIF\n(\t(\nIDENT\tP\n.\t.\nIDENT\tGE\n.\t.\nIDENT\tD\n(\t(\nIDENT\tI\n-\t-\nIDENT\t1\n)\t)\n)\t)\nIDENT\tGO\nIDENT\tTO\nIDENT\t270\nIDENT\tD\n(\t(\nIDENT\tI\n)\t)\n=\t=\nIDENT\tD\n(\t(\nIDENT\tI\n-\t-\nIDENT\t1\n)\t)\nIDENT\t230\nIDENT\tCONTINUE\nCOMMENT\tC\nIDENT\t250\nIDENT\tI\n=\t=\nIDENT\t1\nIDENT\t270\nIDENT\tD\n(\t(\nIDENT\tI\n)\t)\n=\t=\nIDENT\tP\nIDENT\t290\nIDENT\tCONTINUE\nCOMMENT\tC\nIDENT\tGO\nIDENT\tTO\nIDENT\t1001\nCOMMENT\tC     .......... SET ERROR -- NO CONVERGENCE TO AN\nCOMMENT\tC                EIGENVALUE AFTER 30 ITERATIONS ..........\nIDENT\t1000\nIDENT\tIERR\n=\t=\nIDENT\tL\nIDENT\t1001\nIDENT\tRETURN\nIDENT\tEND\n"
