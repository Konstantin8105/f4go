(string) (len=6152) "COMMENT\t  Derived from Brian Downing's WC program, replacing common decls by INCLUDEs\nCOMMENT\tC\nCOMMENT\tC     main(){   Get a file, open it, read and determine semi-useful\nCOMMENT\tC               statistics, print them to screen, and exit quietly.\nCOMMENT\tC           };\nCOMMENT\tC\nCOMMENT\tC     This program is an example word counter that makes use of several\nCOMMENT\tC     Fortran intrinsic functions and data structures, such as; \nCOMMENT\tC     common, sub-routines, functions, inplied do loops, and much, much more.\nCOMMENT\tC\nIDENT\tProgram\nIDENT\tWC\nCOMMENT\tCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC\nCOMMENT\tC     Program:    Word_Count_And_Other_Stuff                                 C\nCOMMENT\tC     Written_By: Brian Downing                                              C\nCOMMENT\tC                 Fordham University                                         C\nCOMMENT\tC     Date:       October 1st-16th, 1990                                     C\nCOMMENT\tCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC\nIDENT\tCharacter\nIDENT\tFname\n*\t*8\nIDENT\t0\nIDENT\tCall\nIDENT\tInitialize\nIDENT\tCall\nIDENT\tGetFileName\n(\t(\nIDENT\tFname\n)\t)\nIDENT\tCall\nIDENT\tGetStats\n(\t(\nIDENT\tFname\n)\t)\nIDENT\tCall\nIDENT\tPrintStats\nIDENT\tEnd\nCOMMENT\tC\nCOMMENT\tC     SubRoutine to get all kinds of neat statistics.\nCOMMENT\tC\nIDENT\tSubRoutine\nIDENT\tGetStats\n(\t(\nIDENT\tFname\n)\t)\nIDENT\tInclude\nSTRING\t'stats.h'\nIDENT\tCharacter\nIDENT\tInline\n*\t*8\nIDENT\t2\n,\t,\nIDENT\tFname\n*\t*8\nIDENT\t0\n,\t,\nIDENT\tCh\nIDENT\tOpen\n(\t(\nIDENT\tUnit\n=\t=\nIDENT\t8\n,\t,\nIDENT\tFile\n=\t=\nIDENT\tFname\n,\t,\nIDENT\tErr\n=\t=\nIDENT\t999\n)\t)\nIDENT\tDo\nIDENT\tWhile\n(\t(\n.\t.\nIDENT\tTRUE\n.\t.\n)\t)\nIDENT\tRead\n(\t(\nIDENT\t8\n,\t,\nIDENT\t10\n,\t,\nIDENT\tEnd\n=\t=\nIDENT\t888\n)\t)\nIDENT\tInLine\nIDENT\tNL\n=\t=\nIDENT\tNL\n+\t+\nIDENT\t1\nIDENT\tLastPos\n=\t=\nIDENT\tINDEX\n(\t(\nIDENT\tInLine\n,\t,\nSTRING\t'  '\n)\t)\nIDENT\tDo\nIDENT\tJ\n=\t=\nIDENT\t1\n,\t,\nIDENT\tLastPos\nIDENT\tCh\n=\t=\nIDENT\tInLine\n(\t(\nIDENT\tJ\n:\t:\nIDENT\tJ\n)\t)\nIDENT\tL\n=\t=\nIDENT\tIntUpCase\n(\t(\nIDENT\tICHAR\n(\t(\nIDENT\tCh\n)\t)\n)\t)\nIDENT\tNEC\n(\t(\nIDENT\tL\n)\t)\n=\t=\nIDENT\tNEC\n(\t(\nIDENT\tL\n)\t)\n+\t+\nIDENT\t1\nIDENT\tIf\n(\t(\n(\t(\nIDENT\tCh\n.\t.\nIDENT\tNE\n.\t.\nSTRING\t' '\n)\t)\n.\t.\nIDENT\tAND\n.\t.\n(\t(\nIDENT\tCh\n.\t.\nIDENT\tNE\n.\t.\nSTRING\t'.'\n)\t)\n)\t)\nIDENT\tThen\nIDENT\tNC\n=\t=\nIDENT\tNC\n+\t+\nIDENT\t1\nIDENT\tElseIf\n(\t(\nIDENT\tCh\n.\t.\nIDENT\tEQ\n.\t.\nSTRING\t'.'\n)\t)\nIDENT\tThen\nIDENT\tNP\n=\t=\nIDENT\tNP\n+\t+\nIDENT\t1\nIDENT\tElse\nIDENT\tNW\n=\t=\nIDENT\tNW\n+\t+\nIDENT\t1\nIDENT\tEndIf\nIDENT\tEndDo\nIDENT\tEndDo\nIDENT\t888\nIDENT\tContinue\nIDENT\tACPW\n=\t=\nIDENT\tREAL\n(\t(\nIDENT\tNC\n)\t)\n/\t/\nIDENT\tREAL\n(\t(\nIDENT\tNW\n)\t)\nIDENT\tAWPS\n=\t=\nIDENT\tREAL\n(\t(\nIDENT\tNW\n)\t)\n/\t/\nIDENT\tREAL\n(\t(\nIDENT\tNP\n)\t)\nIDENT\tReturn\nIDENT\t10\nIDENT\tFormat\n(\t(\nIDENT\ta\n)\t)\nIDENT\t999\nIDENT\tPrint\n*\t*,\nSTRING\t'Error opening file, please verify filename and try again.'\nCOMMENT\tC\nCOMMENT\tC     In the event of improper filename exit abruptly.\nCOMMENT\tC\nIDENT\tSTOP\nIDENT\tEnd\nCOMMENT\tC\nCOMMENT\tC     SubRoutine to print to terminal all of these neat statistics.\nCOMMENT\tC\nIDENT\tSubRoutine\nIDENT\tPrintStats\nIDENT\tInclude\nSTRING\t'stats.h'\nIDENT\tWrite\n(\t(\nIDENT\t5\n,\t,\nIDENT\t10\n)\t)\nIDENT\tACPW\n,\t,\nIDENT\tAWPS\n,\t,\nIDENT\tNW\n,\t,\nIDENT\tNP\n,\t,\nIDENT\tNL\n,\t,\nIDENT\tNC\nIDENT\tWrite\n(\t(\nIDENT\t5\n,\t,\nIDENT\t20\n)\t)\nIDENT\tDo\nIDENT\tJ\n=\t=\nIDENT\t65\n,\t,\nIDENT\t90\nIDENT\tWrite\n(\t(\nIDENT\t5\n,\t,\nIDENT\t40\n)\t)\n(\t(\nIDENT\tCHAR\n(\t(\nIDENT\tJ\n)\t)\n,\t,\nIDENT\tNEC\n(\t(\nIDENT\tJ\n)\t)\n,\t,\n(\t(\nSTRING\t'@'\n,\t,\nIDENT\tK\n=\t=\nIDENT\t1\n,\t,\n(\t(\nIDENT\tNEC\n(\t(\nIDENT\tJ\n)\t)\n/\t/\nIDENT\t10\n)\t)\n)\t)\n,\t,\nIDENT\t1\n(\t(\nSTRING\t'*'\n,\t,\nIDENT\tK\n=\t=\nIDENT\t1\n,\t,\nIDENT\tMOD\n(\t(\nIDENT\tNEC\n(\t(\nIDENT\tJ\n)\t)\n,\t,\nIDENT\t10\n)\t)\n)\t)\n)\t)\nIDENT\tEndDo\nIDENT\tWrite\n(\t(\nIDENT\t5\n,\t,\nIDENT\t50\n)\t)\nIDENT\t10\nIDENT\tFormat\n(\t(\nSTRING\t'1'\nIDENT\t30\nIDENT\tX\nSTRING\t'Word Statistics'\n/\t/\nIDENT\t1\nIDENT\tx\n,\t,\nIDENT\t80\n(\t(\nSTRING\t'*'\n)\t)\n/\t/\nIDENT\t1\nIDENT\t1\nIDENT\tX\nSTRING\t'Average characters per word = '\nIDENT\tF6\n.\t.\nIDENT\t2\n/\t/\nIDENT\t2\nIDENT\t1\nIDENT\tX\nSTRING\t'Average words per sentence  = '\nIDENT\tF6\n.\t.\nIDENT\t2\n/\t/\nIDENT\t3\nIDENT\t1\nIDENT\tX\nSTRING\t'Total number of words       = '\nIDENT\tI5\n/\t/\nIDENT\t4\nIDENT\t1\nIDENT\tX\nSTRING\t'Total number of sentences   = '\nIDENT\tI5\n/\t/\nIDENT\t5\nIDENT\t1\nIDENT\tX\nSTRING\t'Total number of lines       = '\nIDENT\tI5\n/\t/\nIDENT\t6\nIDENT\t1\nIDENT\tX\nSTRING\t'Total number of characters  = '\nIDENT\tI5\n/\t/\n)\t)\nIDENT\t20\nIDENT\tFormat\n(\t(\nIDENT\t29\nIDENT\tx\nSTRING\t'Character Statistics'\n/\t/\nIDENT\t1\nIDENT\tx\n,\t,\nIDENT\t80\n(\t(\nSTRING\t'*'\n)\t)\n/\t/\n)\t)\nIDENT\t30\nIDENT\tFormat\n(\t(\nIDENT\t1\nIDENT\tX\n,\t,\nIDENT\tA\n)\t)\nIDENT\t40\nIDENT\tFormat\n(\t(\nIDENT\t1\nIDENT\tX\n,\t,\nIDENT\tA\nSTRING\t','\nIDENT\tI3\n,\t,\nIDENT\t1\nIDENT\tx\n,\t,\nIDENT\t125\n(\t(\nIDENT\tA\n)\t)\n)\t)\nIDENT\t50\nIDENT\tFormat\n(\t(\nIDENT\t1\nIDENT\tX\nSTRING\t'Legend:'\n/\t/\nIDENT\t9\nIDENT\tx\nSTRING\t'@ equals ten characters'\n,\t,\nIDENT\t1\nSTRING\t', * equals one character.'\n)\t)\nIDENT\tReturn\nIDENT\tEnd\nCOMMENT\tC\nCOMMENT\tC     SubRoutine to prompt for and return a filename.\nCOMMENT\tC\nIDENT\tSubRoutine\nIDENT\tGetFileName\n(\t(\nIDENT\tFname\n)\t)\nIDENT\tCharacter\nIDENT\tFname\n*\t*8\nIDENT\t0\n,\t,\nIDENT\tPrompt\n*\t*7\nIDENT\tPrompt\n=\t=\nSTRING\t'_File: '\nIDENT\tWrite\n(\t(\nIDENT\t5\n,\t,\nIDENT\t10\n)\t)\nIDENT\tPrompt\nIDENT\tRead\n(\t(\nIDENT\t5\n,\t,\nIDENT\t20\n)\t)\nIDENT\tFname\nIDENT\t10\nIDENT\tFormat\n(\t(\nIDENT\t1\nIDENT\tXA\n)\t)\nIDENT\t20\nIDENT\tFormat\n(\t(\nIDENT\tA\n)\t)\nIDENT\tReturn\nIDENT\tEnd\nCOMMENT\tC\nCOMMENT\tC     SubRoutine to initailize globally used variables.\nCOMMENT\tC\nIDENT\tSubRoutine\nIDENT\tInitialize\nIDENT\tCommon\n/\t/\nIDENT\tStats\n/\t/\nIDENT\tA\n,\t,\nIDENT\tB\n,\t,\nIDENT\tJ\n,\t,\nIDENT\tK\n,\t,\nIDENT\tL\n,\t,\nIDENT\tM\n,\t,\nIDENT\tN\n(\t(\nIDENT\t26\n)\t)\nIDENT\tDo\nIDENT\tO\n=\t=\nIDENT\t1\n,\t,\nIDENT\t26\nIDENT\tN\n(\t(\nIDENT\tO\n)\t)\n=\t=\nIDENT\t0\nIDENT\tEndDo\nIDENT\tA\n=\t=\nIDENT\t0\n.\t.\nIDENT\t0\nIDENT\tB\n=\t=\nIDENT\t0\n.\t.\nIDENT\t0\nIDENT\tJ\n=\t=\nIDENT\t0\nIDENT\tK\n=\t=\nIDENT\t0\nIDENT\tL\n=\t=\nIDENT\t0\nIDENT\tM\n=\t=\nIDENT\t0\nIDENT\tReturn\nIDENT\tEnd\nCOMMENT\tC\nCOMMENT\tC     Function to return integer value of a character in range of uppercase.\nCOMMENT\tC\nIDENT\tFunction\nIDENT\tIntUpCase\n(\t(\nIDENT\tI\n)\t)\nIDENT\tIf\n(\t(\n(\t(\nIDENT\tI\n.\t.\nIDENT\tLE\n.\t.\nIDENT\tICHAR\n(\t(\nSTRING\t'z'\n)\t)\n)\t)\n.\t.\nIDENT\tAND\n.\t.\n(\t(\nIDENT\tI\n.\t.\nIDENT\tGE\n.\t.\nIDENT\tICHAR\n(\t(\nSTRING\t'a'\n)\t)\n)\t)\n)\t)\nIDENT\tThen\nIDENT\tIntUpCase\n=\t=\nIDENT\tI\n-\t-\nIDENT\tICHAR\n(\t(\nSTRING\t' '\n)\t)\nIDENT\tElse\nIDENT\tIntUpCase\n=\t=\nIDENT\tI\nIDENT\tEndIf\nIDENT\tReturn\nIDENT\tEnd\n"
