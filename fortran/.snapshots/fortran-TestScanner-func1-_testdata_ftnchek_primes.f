(string) (len=2649) "IDENT\timplicit\nIDENT\tnone\nIDENT\tinteger\nIDENT\tM\n,\t,\nIDENT\tnumprimes\nIDENT\tinteger\nIDENT\tMAXPRIMES\nIDENT\tparameter\n(\t(\nIDENT\tMAXPRIMES\n=\t=\nIDENT\t10000\n)\t)\nIDENT\tinteger\nIDENT\tprimes\n(\t(\nIDENT\tMAXPRIMES\n)\t)\nIDENT\tinteger\nIDENT\tmakeprimes\nIDENT\twrite\n(\t(\ntoken(95)\t*,\n)\t)\nSTRING\t'Enter ceiling on primes'\nIDENT\tread\n(\t(\ntoken(95)\t*,\n)\t)\nIDENT\tM\nCOMMENT\tC Get list of primes up to M\nIDENT\tnumprimes\n=\t=\nIDENT\tmakeprimes\n(\t(\nIDENT\tprimes\n,\t,\nIDENT\tM\n,\t,\nIDENT\tMAXPRIMES\n)\t)\nCOMMENT\tC Print the primes\nIDENT\tcall\nIDENT\tprintarray\n(\t(\nSTRING\t'Primes'\n,\t,\nIDENT\tprimes\n,\t,\nIDENT\tnumprimes\n)\t)\nIDENT\tend\nIDENT\tsubroutine\nIDENT\tprintarray\n(\t(\nIDENT\theading\n,\t,\nIDENT\ta\n,\t,\nIDENT\tn\n)\t)\nIDENT\timplicit\nIDENT\tnone\nIDENT\tcharacter\ntoken(95)\t*(\n)\t)\nIDENT\theading\nIDENT\tinteger\nIDENT\ti\n,\t,\nIDENT\tn\n,\t,\nIDENT\ta\n(\t(\nIDENT\t1\n)\t)\nIDENT\twrite\n(\t(\ntoken(95)\t*,\n)\t)\nIDENT\theading\nIDENT\tdo\nIDENT\ti\n=\t=\nIDENT\t1\n,\t,\nIDENT\tn\nIDENT\twrite\n(\t(\n*\t*,\nSTRING\t'(1x,i4,1x,i5)'\n)\t)\nIDENT\ti\n,\t,\nIDENT\ta\n(\t(\nIDENT\ti\n)\t)\nIDENT\tend\nIDENT\tdo\nIDENT\tend\nIDENT\tinteger\nIDENT\tfunction\nIDENT\tmakeprimes\n(\t(\nIDENT\tp\n,\t,\nIDENT\tn\n,\t,\nIDENT\tmax\n)\t)\nCOMMENT\tC computes array of primes less than or equal to n.\nCOMMENT\tC note: max = limit of number of primes, must be at least 1.\nIDENT\timplicit\nIDENT\tnone\nIDENT\tinteger\nIDENT\tn\n,\t,\nIDENT\tmax\n,\t,\nIDENT\tp\n(\t(\nIDENT\tmax\n)\t)\nIDENT\tinteger\nIDENT\ti\n,\t,\nIDENT\tnumprimes\nIDENT\tlogical\nIDENT\tdivisible\nCOMMENT\tC put the even prime into the list\nIDENT\tnumprimes\n=\t=\nIDENT\t1\nIDENT\tp\n(\t(\nIDENT\tnumprimes\n)\t)\n=\t=\nIDENT\t2\nCOMMENT\tC loop thru odd integers, testing if divisible\nIDENT\tdo\nIDENT\ti\n=\t=\nIDENT\t3\n,\t,\nIDENT\tn\n,\t,\nIDENT\t2\nIDENT\tif\n(\t(\n.\t.\nIDENT\tnot\n.\t.\nIDENT\tdivisible\n(\t(\nIDENT\ti\n,\t,\nIDENT\tp\n,\t,\nIDENT\tnumprimes\n)\t)\n)\t)\nIDENT\tthen\nIDENT\tnumprimes\n=\t=\nIDENT\tnumprimes\n+\t+\nIDENT\t1\nIDENT\tif\n(\t(\nIDENT\tnumprimes\n.\t.\nIDENT\tgt\n.\t.\nIDENT\tmax\n)\t)\nIDENT\tthen\nIDENT\twrite\n(\t(\ntoken(95)\t*,\n)\t)\nSTRING\t'Ran out of space at p='\n,\t,\nIDENT\ti\nIDENT\tstop\nIDENT\telse\nIDENT\tp\n(\t(\nIDENT\tnumprimes\n)\t)\n=\t=\nIDENT\ti\nIDENT\tend\nIDENT\tif\nIDENT\tend\nIDENT\tif\nIDENT\tend\nIDENT\tdo\nCOMMENT\tC return number of primes found\nIDENT\tmakeprimes\n=\t=\nIDENT\tnumprimes\nIDENT\treturn\nIDENT\tend\nIDENT\tlogical\nIDENT\tfunction\nIDENT\tdivisible\n(\t(\nIDENT\tn\n,\t,\nIDENT\tp\n,\t,\nIDENT\tnump\n)\t)\nIDENT\timplicit\nIDENT\tnone\nIDENT\tinteger\nIDENT\tn\n,\t,\nIDENT\tnump\n,\t,\nIDENT\tp\n(\t(\nIDENT\t1\n)\t)\nIDENT\tinteger\nIDENT\ti\nIDENT\tdo\nIDENT\ti\n=\t=\nIDENT\t1\n,\t,\nIDENT\tnump\nIDENT\tif\n(\t(\nIDENT\tmod\n(\t(\nIDENT\tn\n,\t,\nIDENT\tp\n(\t(\nIDENT\ti\n)\t)\n)\t)\n.\t.\nIDENT\teq\n.\t.\nIDENT\t0\n)\t)\nIDENT\tthen\nIDENT\tdivisible\n=\t=\n.\t.\nIDENT\ttrue\n.\t.\nIDENT\treturn\nIDENT\tend\nIDENT\tif\nIDENT\tend\nIDENT\tdo\nIDENT\tdivisible\n=\t=\n.\t.\nIDENT\tfalse\n.\t.\nIDENT\treturn\nIDENT\tend\n"
