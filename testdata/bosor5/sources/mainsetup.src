C=DECK      MAINSETUPLIB
C
C  THIS IS THE MAINSETUP LIBRARY (SOURCE FILE)
C
C
C
C=DECK      MAINSETUP
      PROGRAM MAINS
C
C
C   INPUT DATA FOR MAIN PROCESSOR FOR BOSOR5
C
#if hp700
$hp9000_800 intrinsics
#endif
      DIMENSION LSTEPS(100), TIMES(101)
      COMMON/INDAT/INFILE
      CHARACTER*4 ANSOUT,CHARAC
      LOGICAL ANSL1
      CHARACTER*28 CASE
      CHARACTER*32 VNAM2
      common/case/casename
      character*28 casename
      character*32 fname
#if cnvx
      external signal_handler
      integer dummying, signal
      dummyint = signal(2, signal_handler, -1)
#endif
#if sgi
      integer signal_handler
      external signal_handler
      integer dummyint, signal
      dummyint = signal(2, signal_handler, -1)
#endif
#if star
      integer signal_handler
      external signal_handler
      call signal(2, signal_handler)
#endif
C
C BEG FEB 2009
#if hp700
C     call getarg(2, casename)
      call getarg(1, casename)
#else
      call getarg(1,casename)
#endif
C END FEB 2009
      IOUT = 10
      IFILE = 2
      IFILE3 = 7
      INFILE = 5
C
      CASE = casename
C
      I=INDEX(CASE,' ')
      IF (I.NE.0) THEN
         VNAM2=CASE(:I-1)//'.IMP'
      ELSE
         VNAM2=CASE//'.IMP'
      ENDIF 
C
C FOLLOWING USED FOR VAX/VMS..
c     OPEN(UNIT=IFILE,FILE='BOSOR5:PROMPT.DAT',STATUS='OLD',READONLY)
c     OPEN(UNIT=4,FILE='BOSOR5:PROMPT2.DAT',STATUS='OLD',READONLY)
c     OPEN(UNIT=IFILE3,FILE='BOSOR5:PROMPT3.DAT',STATUS='OLD',READONLY)
C END VAX/VMS OPEN STATEMENTS
C
C FOLLOWING USED FOR UNIX...
      OPEN(UNIT=IFILE,FILE='PROMPT.DAT',STATUS='OLD')
      OPEN(UNIT=4,FILE='PROMPT2.DAT',STATUS='OLD')
      OPEN(UNIT=IFILE3,FILE='PROMPT3.DAT',STATUS='OLD')
#if rs6k
      rewind(IFILE)
      rewind(4)
      rewind(IFILE3)
#endif
C END UNIX OPEN STATEMENTS
C
      CALL REREAD(IOUT,IFILE3,INFILE,VNAM2)
C     
      CALL DATUM(IFILE,2,1,2,INDIC,REALL,CHARAC,IOUT,0,1)
      CALL DATUM(IFILE,3,1,4,INT,REALL,ANSOUT,IOUT,0,1)
      CALL DATUM(IFILE,5,1,2,IFLOW,REALL,CHARAC,IOUT,0,1)
      CALL DATUM(IFILE,6,1,2,ICPRE,REALL,CHARAC,IOUT,0,1)
C
      IF (INDIC.NE.-3) GO TO 10
C
      CALL DATUM(IFILE,13,1,2,NSTEPS,REALL,CHARAC,IOUT,0,1)
      DO 5 I = 1,NSTEPS
      IPROMP = 1
      IF (I.GT.1) IPROMP = 0
      CALL DATUM(IFILE,14,1,2,LSTEPS(I),REALL,CHARAC,IOUT,I,IPROMP)
    5 CONTINUE
C
      DO 6 I = 1,NSTEPS
      IPROMP = 1
      IF (I.GT.1) IPROMP = 0
      CALL DATUM(IFILE,15,1,1,TIMES(I),REALL,CHARAC,IOUT,I,IPROMP)
    6 CONTINUE
C
      GO TO 30
C
   10 CONTINUE
C
      ISTRAT = 0
      REWIND IFILE3
      CALL DATUM(IFILE3,490,1,2,INT,REALL,ANSOUT,IOUT,0,1)
      IF (ANSL1('N',ANSOUT,INFILE)) GO TO 20
      CALL DATUM(IFILE3,494,0,0,INT,REALL,CHARAC,IOUT,0,1)
      CALL DATUM(IFILE3,496,1,2,ISTRAT,REALL,CHARAC,IOUT,0,1)
   20 CONTINUE
      REWIND IFILE
      CALL DATUM(IFILE,7,1,2,KSTEP,REALL,CHARAC,IOUT,0,1)
      CALL DATUM(IFILE,8,1,2,KMAX,REALL,CHARAC,IOUT,0,1)
      CALL DATUM(IFILE,9,1,2,MAXTRL,REALL,CHARAC,IOUT,0,1)
      CALL DATUM(IFILE,11,1,2,ITMAX,REALL,CHARAC,IOUT,0,1)
      CALL DATUM(IFILE,12,1,2,ITIME,REALL,CHARAC,IOUT,0,1)
      IF (ISTRAT.EQ.0)
     1CALL DATUM(IFILE,16,1,2,INT,REALL,ANSOUT,IOUT,0,1)
C
   30 CONTINUE
C
      IF (INDIC.EQ.0) GO TO 60
C
      CALL DATUM(IFILE,17,1,2,N0B,REALL,CHARAC,IOUT,0,1)
      CALL DATUM(IFILE,18,1,1,NMINB,REALL,CHARAC,IOUT,0,1)
      CALL DATUM(IFILE,19,1,1,NMAXB,REALL,CHARAC,IOUT,0,1)
      CALL DATUM(IFILE,20,1,2,INCRB,REALL,CHARAC,IOUT,0,1)
C
   60 CONTINUE
C
      IF (INDIC.EQ.-3) GO TO 95
C
      CALL DATUM(IFILE,21,1,2,INT,TIME,CHARAC,IOUT,0,1)
      IF (ITIME.EQ.0) GO TO 90
      CALL DATUM(IFILE,22,1,2,INT,DTIME,CHARAC,IOUT,0,1)
C
   90 CONTINUE
C
      CALL DATUM(IFILE,23,1,2,INT,REALL,ANSOUT,IOUT,0,1)
C
   95 CONTINUE
      WRITE(6,196)
  196 FORMAT(/' Next, give the command BOSORMAIN'/)
      END
