C=DECK      RINGLIB
C
C THIS IS THE RING LIBRARY (SOURCE FILE)
C
C
C
C=DECK      RGDATA
      SUBROUTINE RGDATA
C
C  200-SEGMENT VERSION OF BOSOR5
C
C     OVERLAY(1,3)    (CDC VERSION)
C     PROGRAM RGDATA  (CDC VERSION)
C
C     CALLED FROM SEGMNT WHICH IS CALLED FROM READIT
C     RING DATA FOR THE DISCRETE RINGS IN THE ITH SEGMENT ARE READ IN.
C     THE RINGS ARE CONSIDERED TO BE ATTACHED TO THE SHELL REFERENCE
C     SURFACE AT A SINGLE MESH POINT, ISTATN. THE CROSS-SECTION HAS
C     THE SAME ROTATION AS THE ROTATION OF THE SHELL WALL AT THAT
C     MESH STATION.
C
      COMMON/BGEOM/ B(10000)
      COMMON/GLOBAL/IDZ,IZRING(99),ISAVE(20),INOTE
      COMMON/IPOSN/IPOS,IPOS1,IPOS2,IPOS3,IPOS4
      COMMON/RGEOM2/Z(2000),ZAX(2000),ANGLE(2000),S(2000)
      COMMON/SEGS/NSEG,M2,I5(201),I2,I2G
      COMMON/INTRG/NRINGS
      COMMON/RINDEX/JBEGIN,KBEGIN,LBEGIN,KRSEG
      COMMON/RCOEFS/RING(3000)
      COMMON/ALLRNG/NTOT,IPRE
      COMMON/IMISC/ISEG,ITOT,KRING
      COMMON/RNGGEO/RC(99),AREA(99),ER(99),IY(99),IX(99),IXY(99),IP(99)
      COMMON/RING2/GAM(99),GJ(99),YC(99),XC(99),E1(80),E2(99),PPI(99)
      COMMON/RMASS/RM(99)
      COMMON/RGTEMP/TNR(99),TMX(99),TMRY(99)
      COMMON/PRMFIL/IFILE,IFILE2,IOUT,IPRM(5)
      COMMON/PRMOUT/IFILE3,IFILE4
      COMMON/INDAT/INFILE
      COMMON/JRING/JJRING
      CHARACTER*4 APLAST
      CHARACTER*4 CHARAC
      LOGICAL ANSL1
      REAL IY,IX,IXY,IP
      DIMENSION IRG(20),NTYPER(20)
   10 FORMAT(//48H ENTERING SUBROUTINE RGDATA FOR SEGMENT NUMBER    I3/)
      I5I = I5(ISEG)
      WRITE(IOUT,2)
    2 FORMAT(6X,'H',9X,'$ DISCRETE RING INPUT FOLLOWS...')
   15 CONTINUE
      CALL DATUM(IFILE2,148,1,2,NRINGS,REALL,CHARAC,IOUT,0,1)
      IF (NRINGS.EQ.0) GO TO 60
      IF (NRINGS.LT.0.OR.NRINGS.GT.20) THEN
       WRITE(6,*)' NRINGS MUST BE IN THE RANGE FROM 0 TO 20'
       CALL ERREX
      ENDIF
C
      IPRM(2) = 149
      JJRING = 1
C
      CALL STA(IRG,ZAX(ITOT),B(IPOS2),B(IPOS2+I5I),S(ITOT),NRINGS,I5I)
C
      JJRING = 0
C
      DO 65 J = 1,NRINGS
      IPROMP = 1
      IF (J.GT.1) IPROMP = 0
   64 CONTINUE
      CALL DATUM(IFILE2,152,1,2,NTYPER(J),REALL,CHARAC,IOUT,J,IPROMP)
      IF (NTYPER(J).NE.0.AND.NTYPER(J).NE.1) THEN
       WRITE(6,*)' NTYPER  MUST BE EITHER   0  or  1'
       CALL ERREX
      ENDIF
C
   65 CONTINUE
C
C     NTYPER(J) = 0 MEANS 'FAKE'RING PRESENT JUST FOR LINE LOAD
C     NTYPER(J) = 1 = RING SEGMENT GEOMETRIES AND MAT'L PROPS READ IN.
C
      DO 50 J=1,NRINGS
      REWIND IFILE2
      KRING = KRING + 1
      IPOSR = IPRE*(KRING-1)+1
      RING(IPOSR)= 1000*ISEG + IRG(J)
      L = IRG(J)
      IARG = IPOS2 + L - 1
      CALL RNGSEG(J,NTYPER(J),ISEG,L,KRSEG,JBEGIN,KBEGIN,LBEGIN,KRING,
     1 B(IARG),RING(IPOSR))
C     GLOBAL STATION OF KTH DISCRETE RING STORED IN IZRING(K)
      IZRING(KRING) = ITOT + L - 1
   50 CONTINUE
   60 CONTINUE
      RETURN
C     RETURN CARD NOT NEEDED IN CDC VERSION
      END
C=DECK      RNGSEG
      SUBROUTINE RNGSEG(JRNG,NTYPER,ISEG,JPOINT,KK,JBEGIN,KBEGIN,
     1 LBEGIN,KKK,R,RING)
C
C     THIS SUBROUTINE READS IN DATA FOR A RING CONSISTING OF N STRAIGHT
C     SEGMENTS WHICH MAY BE ORIENTED AT ANY ARBITRARY ANGLE WITH
C     RESPECT TO THE HORIZONTAL AND VERTICAL DIRECTIONS.
C
      COMMON/RNGGEO/RC(99),AREA(99),ER(99),IY(99),IX(99),IXY(99),IP(99)
      COMMON/RING2/GAM(99),GJ(99),YC(99),XC(99),E1(99),E2(99),PPI(99)
      COMMON/RMASS/RM(99)
      REAL IY,IX,IXY,IP
      COMMON/RGTEMP/TNR(99),TMX(99),TMRY(99)
      COMMON/PRMFIL/IFILE,IFILE2,IOUT,IPRM(5)
      COMMON/PRMOUT/IFILE3,IFILE4
      COMMON/INDAT/INFILE
      CHARACTER*4 APLAST
      CHARACTER*4 CHARAC
      LOGICAL ANSL1
      DIMENSION	RING(20)
      COMMON/RINTRR/NGEOM(199),NTEMP(199),NMATL(199)
      COMMON/RINTRS/INTEG(199),NCREEP(199)
      COMMON/RCDATA/RCREEN(9),RCREEM(9),RCREEA(9),RCREEB(9)
      COMMON/RPLST1 /D1(99),D2(99),PHI(99),T(99),FL(99),E(10),ALPHA(10)
      COMMON/RPLST2/TEMP(100),EPS(100),SIGMA(100)
      COMMON/RPLST3/SIGMA0(900),EPS0(900),EPCREP(900)
      COMMON/RPLST4/JBEG(99),KBEG(10),NPOINT(10) ,NSUM1(199),NSUM2(199)
      COMMON/RPLST5/NTYP(99),NPARTS(99)
      COMMON/RPLST6/TEMP2(100),TEMP3(100),STEPT1(99),STEPT2(99),
     1              STEPT3(99)
      COMMON/ISETP/ISETUP
      DIMENSION	C(10),DC(9,10),	XS(99),	YS(99)
   10 FORMAT(10I6)
   20 FORMAT(6E12.8)
      NTYP(KKK)	= NTYPER
      IF (NTYPER.EQ.0) GO TO 560
      WRITE (IFILE4,30)
   30 FORMAT(////' **************************************************')
      WRITE (IFILE4,40)KKK,KKK,KKK,KKK,KKK,KKK,KKK,KKK,KKK,KKK
   40 FORMAT(' ***** GLOBAL RING NO.',10I6,'  FOLLOWS*****')
C
      CALL DATUM(IFILE2,153,1,2,NPARTS(KKK),REALL,CHARAC,IOUT,JRNG,1)
      IF (NPARTS(KKK).LE.0.OR.NPARTS(KKK).GT.10) THEN
       WRITE(6,*)' NPARTS  MUST BE IN THE RANGE FROM  1  TO  10'
       CALL ERREX
      ENDIF
C
      WRITE (IFILE4,50)ISEG,JPOINT,NPARTS(KKK)
C    1 ' CONSISTS OF'I2,' SUBSEGMENTS')
   50 FORMAT(//' THIS DISCRETE RING IN SHELL SEGMENT',I3,' MESH POINT',
     1 I3,' CONSISTS OF',I2,' SUBSEGMENTS')
      NPART = NPARTS(KKK)
      DO 400 I=1,NPART
      REWIND IFILE2
      KK = KK +	1
      WRITE (IFILE4,60)KK,KK,KK,KK,KK,KK,KK,KK,KK,KK
C  60 FORMAT(' ***** GLOBAL RING SEGMENT NO.' 10I6,'  FOLLOWS*****')
   60 FORMAT(' ***** GLOBAL RING SEGMENT NO.',10I6,'  FOLLOWS*****')
C     FIRST READ THE CONTROL PARAMETERS.
      IF (I.EQ.1.AND.JRNG.EQ.1)
     1 CALL DATUM(IFILE2,154,0,0,INT,REALL,CHARAC,IOUT,0,1)
C
      CALL DATUM(IFILE2,155,1,2,NGEOM(KK),REALL,CHARAC,IOUT,I,1)
      IF (NGEOM(KK).LE.0) THEN
       WRITE(6,*)' NGEOM  MUST BE  1  OR MORE.'
       CALL ERREX
      ENDIF
C
      CALL DATUM(IFILE2,156,1,2,NTEMP(KK),REALL,CHARAC,IOUT,I,1)
      IF (NTEMP(KK).LE.0) THEN
       WRITE(6,*)' NTEMP  MUST BE  1  OR MORE.'
       CALL ERREX
      ENDIF
C
      CALL DATUM(IFILE2,157,1,2,NMATL(KK),REALL,CHARAC,IOUT,I,1)
      IF (NMATL(KK).LE.0.OR.NMATL(KK).GT.9) THEN
       WRITE(6,*)' NMATL  MUST BE IN THE RANGE FROM  1  TO  9'
       CALL ERREX
      ENDIF
C
      CALL DATUM(IFILE2,158,1,2,INTEG(KK),REALL,CHARAC,IOUT,I,1)
      INTEGK = INTEG(KK)
      IF (INTEGK.NE.5.AND.INTEGK.NE.7.AND.INTEGK.NE.9) THEN
       WRITE(6,*)' INTEG  MUST BE EITHER  5  or  7  or  9'
       CALL ERREX
      ENDIF
C
      CALL DATUM(IFILE2,159,1,2,NCREEP(KK),REALL,CHARAC,IOUT,I,1)
      IF (NCREEP(KK).NE.0.AND.NCREEP(KK).NE.1) THEN
       WRITE(6,*)' NCREEP  MUST BE EITHER  0  or  1'
       CALL ERREX
      ENDIF
C
      CALL DATUM(IFILE2,160,1,2,NUMBT,REALL,CHARAC,IOUT,I,1)
      IF (NUMBT.NE.0.AND.NUMBT.NE.1.AND.NUMBT.NE.2.AND.NUMBT.NE.3) THEN
       WRITE(6,*)' NUMBT  MUST BE EITHER  0  or  1  or  2  or  3'
       CALL ERREX
      ENDIF
C
      WRITE(IFILE4,70)KKK,KK,I,NGEOM(KK),NTEMP(KK),NMATL(KK),INTEG(KK),
     1 NUMBT
   70 FORMAT(//' DISCRETE RING NO.',I3,'  GLOBAL RING SEGMENT NO.',I3,
     1 '    LOCAL RING SEG. NO.',I2,/'   GEOMETRY TYPE=',I3,
     1 '  TEMP. DIST. TYPE=',I3,'  MATERIAL TYPE=',I3,'  NO. OF INTEGRAT
     2ION POINTS=',I2,/ '   NUMBER OF TYPES OF TEMPERATURE VARIATIONS='
     3I2)
      IF (INTEG(KK).LT.3) INTEG(KK) = 3
      IF (INTEG(KK).GT.9) INTEG(KK) = 9
      FINTEG = INTEG(KK)
      F2 = FINTEG/2.
      IF3 = INTEG(KK)/2
      F3 = IF3
      IF (F3.EQ.F2) INTEG(KK) =	INTEG(KK) + 1
      KM = KK -	1
C     READ GEOMETRY PARAMETERS FOR THIS	RING SEGMENT IF	THEY HAVE NOT
C     BEEN READ	BEFORE.	FIRST DETERMINE	IF THEY	HAVE BEEN READ BEFORE.
      CALL DATUM(IFILE2,161,1,1,INT,REALL,APLAST,IOUT,0,1)
      IF (ANSL1('Y',APLAST,INFILE)) GO TO 110
C
      IF (KM.EQ.0) GO TO 90
      DO 80 J=1,KM
      IF (NGEOM(KK).EQ.NGEOM(J)) GO TO 110
   80 CONTINUE
   90 CONTINUE
      J = 0
      WRITE(6,92) I
   92 FORMAT(/' Next, provide ring segment geometry (see p. P25) for'/
     1        ' ring segment no.',I2,' . . .'/)
      NG = NGEOM(KK)
      CALL DATUM(IFILE2,162,1,2,INT,D1(NG),CHARAC,IOUT,I,1)
      CALL DATUM(IFILE2,163,1,2,INT,D2(NG),CHARAC,IOUT,I,1)
      CALL DATUM(IFILE2,164,1,2,INT,PHI(NG),CHARAC,IOUT,I,1)
      CALL DATUM(IFILE2,165,1,2,INT,T(NG),CHARAC,IOUT,I,1)
      CALL DATUM(IFILE2,166,1,2,INT,FL(NG),CHARAC,IOUT,I,1)
C
      WRITE (IFILE4,100)D1(NG),D2(NG),PHI(NG),T(NG),FL(NG)
  100 FORMAT(//' DIST. FROM ATTACH. PT. ON REF. SURF. TO BEGINNING OF LO
     1CAL RING SEGMENT'/' RADIAL COMPONENT=',1PE12.3,'  AXIAL COMPONENT=
     2',1PE12.3,/50X,'ANGLE=',1PE12.3,'    THICKNESS=',1PE12.3,
     3  '    LENGTH=',1PE12.3)
      GO TO 130
  110 CONTINUE
      WRITE (IFILE4,120)J
  120 FORMAT(  ' GEOMETRY OF THIS RING SEGMENT IS IDENTICAL TO THAT OF
     1GLOBAL RING SEGMENT NO.',I3)
  130 CONTINUE
C     READ TEMPERATURE DISTRIBUTION FOR	THIS RING SEGMENT IF IT	HAS
C     NOT BEEN READ BEFORE. FIRST DETERMINE IF IT HAS BEEN READ	BEFORE.
      CALL DATUM(IFILE2,167,1,2,INT,REALL,APLAST,IOUT,0,1)
      IF (ANSL1('Y',APLAST,INFILE)) GO TO 170
C
      IF (KM.EQ.0) GO TO 150
      DO 140 J=1,KM
      IF (NTEMP(KK).EQ.NTEMP(J)) GO TO 170
  140 CONTINUE
  150 CONTINUE
      J = 0
      JEND = INTEG(KK) + JBEGIN	- 1
      IF (NUMBT.GT.0) WRITE(6,138) I
  138 FORMAT(/' Ring segment no.',I2,'.  First temperature rise'/
     1        ' distribution at integration points...'/)
      JJJ = 0
      DO 155 JJ = JBEGIN,JEND
      TEMP(JJ) = 0.
      JJJ = JJJ + 1
      IPROMP = 1
      IF (JJJ.GT.1) IPROMP = 0
      IF (NUMBT.EQ.0) GO TO 155
      CALL DATUM(IFILE2,168,1,2,INT,TEMP(JJ),CHARAC,IOUT,JJJ,IPROMP)
  155 CONTINUE
C
      WRITE (IFILE4,160)(TEMP(JJ),JJ=JBEGIN,JEND)
      JJMAX = 100
      IF (JEND.GT.JJMAX) WRITE(6,151)
  151 FORMAT(//' TOO MANY DIFFERENT KINDS OF TEMPERATURE DISTRIBUTIONS I
     1N RING SEGMENTS.'//)
      IF (JEND.GT.JJMAX) CALL ERREX
      IF (NUMBT.GT.1) WRITE(6,152)I
  152 FORMAT(/' Ring segment no.',I2,'.  Second temperature rise'/
     1        ' distribution at integration points...'/)
      JJJ = 0
      DO 154 JJ = JBEGIN,JEND
      TEMP2(JJ) = 0.
      JJJ = JJJ + 1
      IPROMP = 1
      IF (JJJ.GT.1) IPROMP = 0
      IF (NUMBT.LT.2) GO TO 154
      CALL DATUM(IFILE2,169,1,2,INT,TEMP2(JJ),CHARAC,IOUT,JJJ,IPROMP)
  154 CONTINUE
C
      WRITE(IFILE4,161) (TEMP2(JJ),JJ=JBEGIN,JEND)
  161 FORMAT(//' SECOND TYPE OF TEMPERATURE RISE DIST. AT EQUALLY SPACED
     1 POINTS IN THIS SEGMENT IS'/ 1P10E13.3)
      IF (NUMBT.GT.2) WRITE(6,153) I
  153 FORMAT(/' Ring segment no.',I2,'.  Third temperature rise'/
     1        ' distribution at integration points...'/)
       JJJ = 0
      DO 165 JJ = JBEGIN,JEND
      TEMP3(JJ) = 0.
      JJJ = JJJ + 1
      IPROMP = 1
      IF (JJJ.GT.1) IPROMP = 0
      IF (NUMBT.LT.3) GO TO 165
      CALL DATUM(IFILE2,170,1,2,INT,TEMP3(JJ),CHARAC,IOUT,JJJ,IPROMP)
  165 CONTINUE
C
      WRITE(IFILE4,162) (TEMP3(JJ),JJ=JBEGIN,JEND)
  162 FORMAT(//' THIRD TYPE OF TEMPERATURE RISE DIST. AT EQUALLY SPACED
     1 POINTS IN THIS SEGMENT IS'/ 1P10E13.3)
  156 CONTINUE
      NT = NTEMP(KK)
      JBEG(NT) = JBEGIN
      JBEGIN = JBEGIN +	INTEG(KK)
  160 FORMAT(//' TEMPERATURE RISE DISTRIBUTION AT THE EQUALLY SPACED POI
     1NTS IN THIS SEGMENT IS'/ 1P10E13.3)
      GO TO 190
  170 CONTINUE
      WRITE (IFILE4,180)J
  180 FORMAT(  ' TEMPERATURE RISE DISTRIBUTION OF THIS RING SEGMENT IS I
     1DENTICAL TO THAT OF GLOBAL RING SEGMENT NO.',I3)
  190 CONTINUE
C     READ MATERIAL PROPERTIES FOR THIS	RING SEGMENT IF	THEY HAVE NOT
C     BEEN READ	BEFORE.	FIRST CHECK TO SEE IF THEY HAVE	BEEN
      WRITE (6,212) I
  212 FORMAT(/' Material properties for ring segment no.',I2,'.'/
     1        ' You must provide properties even though the same'/
     1        ' material may have been previously specified by you'/
     1        ' for a shell wall segment.  You need not specify'/
     1        ' material properties here if they have been previously'/
     1        ' specified for a ring segment.'/)
      CALL DATUM(IFILE2,171,1,1,INT,REALL,APLAST,IOUT,0,1)
      IF (ANSL1('Y',APLAST,INFILE)) GO TO 260
      IF (KM.EQ.0) GO TO 210
      DO 200 J=1,KM
      IF (NMATL(KK).EQ.NMATL(J)) GO TO 260
  200 CONTINUE
  210 CONTINUE
      J = 0
      NG = NMATL(KK)
C
      CALL DATUM(IFILE2,172,1,1,INT,E(NG),CHARAC,IOUT,I,1)
      CALL DATUM(IFILE2,173,1,1,INT,ALPHA(NG),CHARAC,IOUT,I,1)
      CALL DATUM(IFILE2,174,1,1,INT,REALL,APLAST,IOUT,0,1)
      IF (ANSL1('Y',APLAST,INFILE)) GO TO 214
      NPOINT(NG) = 2
      KEND = NPOINT(NG) + KBEGIN - 1
      EPS(KBEGIN) = 0.
      EPS(KBEGIN+1) = 1.
      SIGMA(KBEGIN) = 0.
      SIGMA(KBEGIN+1) = E(NG)
      GO TO 217
  214 CONTINUE
C
      CALL DATUM(IFILE2,175,1,2,NPOINT(NG),REALL,CHARAC,IOUT,I,1)
      IF (NPOINT(NG).LT.2.OR.NPOINT(NG).GT.20) THEN
       WRITE(6,*)' NPOINT  MUST BE IN THE RANGE FROM  2  TO  20'
       CALL ERREX
      ENDIF
C
      KEND = NPOINT(NG)	+ KBEGIN - 1
      JJJ = 0
      DO 215 JJ = KBEGIN,KEND
      JJJ = JJJ + 1
      IPROMP = 1
      IF (JJJ.GT.1) IPROMP = 0
      CALL DATUM(IFILE2,176,1,1,INT,EPS(JJ),CHARAC,IOUT,JJJ,IPROMP)
  215 CONTINUE
C
      JJJ = 0
      DO 216 JJ = KBEGIN,KEND
      JJJ = JJJ + 1
      IPROMP = 1
      IF (JJJ.GT.1) IPROMP = 0
      CALL DATUM(IFILE2,177,1,1,INT,SIGMA(JJ),CHARAC,IOUT,JJJ,IPROMP)
  216 CONTINUE
C
  217 CONTINUE
      JJMAX = 100
      IF (KEND.GT.JJMAX) WRITE(6,211)
  211 FORMAT(//' TOO MANY DATA POINTS FOR RING STRESS-STRAIN CURVES'//)
      IF (KEND.GT.JJMAX) CALL ERREX
      DE1 = EPS(KEND) -	EPS(KEND-1)
      DS1 = SIGMA(KEND)	- SIGMA(KEND-1)
      KEND1 = KEND + 1
      EPS(KEND1) = 100.0*EPS(KEND)
      DE2 = EPS(KEND1) - EPS(KEND)
      SIGMA(KEND1) = SIGMA(KEND) + DS1*DE2/DE1
      NPOINT(NG) = NPOINT(NG) +	1
      WRITE (IFILE4,220)NG,E(NG),ALPHA(NG)
  220 FORMAT(// '           STRAIN        STRESS         FOR RING ',
     1          'MATERIAL TYPE',I2,'  MODULUS=',1PE12.3,
     2          '  THERMAL EXPANSION COEF,ALPHA=',1PE12.3)
      RCREEN(NG) = 0.0
      RCREEM(NG) = 0.0
      RCREEA(NG) = 0.0
      RCREEB(NG) = 0.0
      IF (NCREEP(KK).EQ.0) GO TO 235
      IF (JRNG.EQ.1) WRITE(6,225) I
  225 FORMAT(/' Creep properties (see p. P27 for creep law) for ring'/
     1        ' segment no.',I2,'.  Note that the coefficients RN,'/
     1        ' RM, RA, and RB should be such that the effective'/
     1        ' creep strain, EBAR(Creep), on p. P27 is in per cent,'/
     1        ' not in strain.'/)
      CALL DATUM(IFILE2,178,1,1,INT,RCREEN(NG),CHARAC,IOUT,0,1)
      CALL DATUM(IFILE2,179,1,1,INT,RCREEM(NG),CHARAC,IOUT,0,1)
      CALL DATUM(IFILE2,180,1,1,INT,RCREEA(NG),CHARAC,IOUT,0,1)
      CALL DATUM(IFILE2,181,1,1,INT,RCREEB(NG),CHARAC,IOUT,0,1)
C
      WRITE (IFILE4,230)RCREEN(NG),RCREEM(NG),RCREEA(NG),RCREEB(NG)
  230 FORMAT(40X,'  CREEP VARIABLES.. TIME EXP.=',1PE12.3,' STRESS EXP.=
     1',1PE12.3,/58X,'   YIELD STRESS=',1PE12.3,'  TE1=',1PE12.3)
  235 CONTINUE
      KBEG(NG) = KBEGIN
      DO 250 JJ	= KBEGIN,KEND1
      WRITE (IFILE4,240)JJ,EPS(JJ),SIGMA(JJ)
  240 FORMAT(I3,1P2E15.3)
  250 CONTINUE
      KBEGIN = KBEGIN +	NPOINT(NG)
      GO TO 280
  260 CONTINUE
      WRITE (IFILE4,270)J
  270 FORMAT(  '  MATERIAL PROPERTIES OF THIS RING SEGMENT ARE IDENTICAL
     1 TO THOSE OF GLOBAL RING SEGMENT NO.',I3)
  280 CONTINUE
      LEND = LBEGIN + INTEG(KK)	- 1
  290 CONTINUE
      LBEGIN = LBEGIN +	INTEG(KK)
      IF (LBEGIN.LE.901) GO TO 295
      WRITE(6,292) KKK, KK
  292 FORMAT(//' TOO MANY INTEGRATION STATIONS (TOTAL) IN ALL OF THE'/,
     1' DISCRETE RINGS COMBINED. RAN OUT OF SPACE ON GLOBAL RING NO.',
     2I3,' , GLOBAL RING SEGMENT NO.',I4/)
      CALL ERREX
  295 CONTINUE
      WRITE (IFILE4,390)
  390 FORMAT('           -----------------------------------------------
     1---------------------------------------------------------------')
      NSUM1(KK)	= NMATL(KK) + 100*INTEG(KK) + 10000*NCREEP(KK)
      NSUM2(KK)	= NGEOM(KK) + 100*NTEMP(KK)
  400 CONTINUE
C     NOW READ POSITION	OF RING	SHEAR CENTER RELATIVE TO ATTACHMENT
C     POINT ON SHELL REFERENCE SURFACE,	XS(KKK)	= RADIAL DISTANCE
C     YS(KKK) =	AXIAL DISTANCE
      CALL DATUM(IFILE2,182,0,0,INT,REALL,CHARAC,IOUT,0,1)
      CALL DATUM(IFILE2,183,1,2,INT,XS(KKK),CHARAC,IOUT,JRNG,1)
      CALL DATUM(IFILE2,184,1,2,INT,YS(KKK),CHARAC,IOUT,JRNG,1)
C
      STEPT1(KKK) = 0.
      STEPT2(KKK) = 0.
      STEPT3(KKK) = 0.
      IF (NUMBT.EQ.0) GO TO 405
      CALL DATUM(IFILE2,185,0,0,INT,REALL,CHARAC,IOUT,0,1)
      CALL DATUM(IFILE2,186,1,2,INT,STEPT1(KKK),CHARAC,IOUT,0,1)
      IF (NUMBT.LT.2) GO TO 405
      CALL DATUM(IFILE2,187,1,1,INT,STEPT2(KKK),CHARAC,IOUT,0,1)
      IF (NUMBT.LT.3) GO TO 405
      CALL DATUM(IFILE2,188,1,1,INT,STEPT3(KKK),CHARAC,IOUT,0,1)
  405 CONTINUE
C
      WRITE(IFILE4,410) XS(KKK),YS(KKK)
  410 FORMAT(//' POSITION OF RING SHEAR CENTER MEASURED FROM ATTACHMENT
     1POINT...'/50X,'RADIAL DISTANCE,XS=',1PE12.3,'   AXIAL DISTANCE,YS=
     2',1PE12.3)
      WRITE(IFILE4,412) KKK,NUMBT,STEPT1(KKK),STEPT2(KKK),STEPT3(KKK)
  412 FORMAT(//' NUMBER OF DIFFERENT TYPES OF TEMPERATURE VARIATION IN R
     1ING NO.',I3,' = ',I2/,' TEMPORAL FUNCTION TYPES=',1P3E10.2)
C     NOW FIND THE LOCATION OF THE RING	CENTROID
      SUMR = 0.0
      SUMZ = 0.0
      SUMA = 0.0
      IF (ISETUP.EQ.1) RETURN
      DO 420 I=1,NPART
      J	= KK - NPART + I
      NG = NGEOM(J)
      NM = NMATL(J)
      PHIRAD = PHI(NG)*3.1415927/180.
      AI = T(NG)*FL(NG)*E(NM)
      SUMA = SUMA + AI
      SUMR = SUMR +(D1(NG) +FL(NG)*COS(PHIRAD)/2.)*AI
      SUMZ = SUMZ +(D2(NG) +FL(NG)*SIN(PHIRAD)/2.)*AI
  420 CONTINUE
      E1(KKK) =	0.0
      E2(KKK) =	0.0
      IF (SUMA.EQ.0.0) GO TO 425
       E1(KKK) = SUMR/SUMA
       E2(KKK) = SUMZ/SUMA
  425 CONTINUE
C     CENTROID LOCATION	OF KKKTH RING RADIAL DISTANCE =	 E1(KKK),
C     AXIAL DISTANCE =	E2(KKK), MEASURED FROM RING ATTACHMENT POINT
C     WHICH IS ON THE SHELL REFERENCE SURFACE.
      WRITE (IFILE4,430)E1(KKK),E2(KKK)
  430 FORMAT(//' POSITION OF RING CENTROID MEASURED  FROM ATTACHMENT POI
     1NT ON REFERENCE SURFACE...'/50X,'RADIAL DISTANCE,E1=',1PE12.3,
     2 '    AXIAL DISTANCE,E2=',1PE12.3)
C
C     NOW PERFORM NUMERICAL INTEGRATION	OVER RING AREA
C
      DO 440 I=1,10
  440 C(I) = 0.0
      DO 480 I=1,NPART
      J	= KK - NPART + I
      NG = NGEOM(J)
      NM = NMATL(J)
      NT = NTEMP(J)
      FINTEG = INTEG(J)
      DS = FL(NG)/(FINTEG - 1.)
      S	= - DS
      PHIRAD = PHI(NG)*3.1415927/180.
      X0 = D1(NG) -  E1(KKK)
      Y0 = D2(NG) -  E2(KKK)
      CP = COS(PHIRAD)
      SP = SIN(PHIRAD)
      SP2 = SIN(2.*PHIRAD)
C     FIND VALUES OF INTEGRAND FOR ALL INTEGRATION POINTS. MAXIMUM
C     OF 9 INTEGRATION POINTS PER RING SEGMENT PERMITTED.
      INT = INTEG(J)
      DMIN = AMIN1(FL(NG),T(NG))
      DO 450 JJ=1,INT
      S	= S + DS
      X	= X0 + S*CP
      Y	= Y0 + S*SP
      JJB = JBEG(NT) + JJ - 1
      LLB = LBEGIN - INTEG(KK) + JJ - 1
      B = -ALPHA(NM)*TEMP(JJB)
      SINC = DS/3.
      ET = E(NM)*T(NG)*SINC
      FIX = ET*T(NG)**2/12.
      DC(JJ,1) = ET
      DC(JJ,2) = ET*X
      DC(JJ,3) = ET*Y
      DC(JJ,4) = ET*X*X + FIX*SP**2
      DC(JJ,5) = ET*X*Y + .5*FIX*SP2
      DC(JJ,6) = ET*Y*Y + FIX*CP**2
      DC(JJ,7) = ET*B
      DC(JJ,8) = ET*B*X
      DC(JJ,9) = ET*B*Y
      FNU = 0.3
C     SHEAR STIFFNESS FOR OPEN SECTION ONLY.
      DC(JJ,10)	= ET*DMIN**2/(6.*(1.+FNU))
  450 CONTINUE
      IC = INT - 1
      DO 470 JJ=1,IC,2
      DO 460 JJJ=1,10
  460 C(JJJ) = C(JJJ) +DC(JJ,JJJ) +4.*DC(JJ+1,JJJ) +DC(JJ+2,JJJ)
  470 CONTINUE
  480 CONTINUE
C     FIND OUT IF MODULUS IS THE SAME IN ALL SEGMENTS OF THIS RING
      IFLAG = 1
      DO 490 I=1,NPART
      J	= KK - NPART + I
      NM = NMATL(J)
      IF (I.EQ.1) ES = E(NM)
      IF (I.EQ.1) GO TO	490
      IF (E(NM).EQ.ES) GO TO 490
      IFLAG = 0
  490 CONTINUE
C     IF IFLAG = 1 THE MODULI OF ALL RING SEGMENTS ARE EQUAL8 AND WE CAN
C     DIVIDE THE C-QUANTITIES THRU IN ORDER TO OBTAIN THE MOMENTS OF
C     INERTIA AND AREA
      RC(KKK) =	R +  E1(KKK)
      ER(KKK) =	E(NM)
      GJ(KKK) =	C(10)
      XC(KKK) =	XS(KKK)	-  E1(KKK)
      YC(KKK) =	YS(KKK)	-  E2(KKK)
      IF (IFLAG.NE.1) GO TO 500
      AREA(KKK)	= C(1)/E(NM)
      IY(KKK) =	C(4)/E(NM)
      IX(KKK) =	C(6)/E(NM)
      IXY(KKK)=	C(5)/E(NM)
      IP(KKK) =	IX(KKK)	+ IY(KKK)
  500 TNR(KKK) = -C(7)
      TMX(KKK) = - C(9)
      TMRY(KKK)	= - C(8)
      IF (IFLAG.NE.1) GO TO 510
      WRITE (IFILE4,520)KKK,RC(KKK),ER(KKK),AREA(KKK),GJ(KKK)
      WRITE (IFILE4,530)IY(KKK),IX(KKK),IXY(KKK),XC(KKK),YC(KKK)
  510 WRITE (IFILE4,540) TNR(KKK),TMX(KKK),TMRY(KKK)
  520 FORMAT(//' RING NO.',I3,' CENTROIDAL RADIUS=',1PE12.3,
     1 '  ELASTIC MODULUS=',1PE12.3,'  AREA=',1PE12.3,'  GJ=',1PE12.3)
  530 FORMAT(//12X,' IY=',1PE12.3,'  IX=',1PE12.3,'  IXY=',1PE12.3,
     1 '  XC=',1PE12.3,'  YC=',1PE12.3)
  540 FORMAT(//12X,' HOOP THERMAL RESULTANT=',1PE12.3,'  THERMAL MOMENT
     1ABOUT X-AXIS=',1PE12.3,'  THERMAL MOMENT ABOUT Y-AXIS=',1PE12.3)
      WRITE (IFILE4,550)(C(I),I=1,6),C(10)
  550 FORMAT(//'  EA=',1PE12.3,'  EX=',1PE12.3,'  EY=',1PE12.3,
     1 '  EXX=',1PE12.3,'  EXY=',1PE12.3,'  EYY=',1PE12.3,
     2 '  GJ=',1PE12.3)
      RING(2) =	XS(KKK)
      RING(3) =	YS(KKK)
      RING(4) =	E1(KKK)
      RING(5) =	E2(KKK)
      IF (RC(KKK).GT.0.0) GO TO	555
      WRITE(6,553) KKK
  553 FORMAT(//40H INPUT DATA ERROR..RADIUS OF RING NO.         I3,
     1 19H  IS ZERO OR LESS.                    //)
      CALL ERREX
  555 CONTINUE
      RING(6) =	(C(1) -	C(2)/RC(KKK) +C(4)/RC(KKK)**2)/RC(KKK)
      RING(12)=	RING(6)
      RING(7 )=	(C(2) -	C(4)/RC(KKK))/RC(KKK)
      RING(13)=	RING(7)
      RING(8 )=	C(4)/RC(KKK)
      RING(14)=	RING(8)
      RING(9 )=	(C(3) -	C(5)/RC(KKK))/RC(KKK)
      RING(15)=	RING(9)
      RING(10)=	C(5)/RC(KKK)
      RING(16)=	RING(10)
      RING(11)=	C(6)/RC(KKK)
      RING(17)=	RING(11)
      RING(18)=	C(7)
      RING(19)=	C(8)
      RING(20)=	C(9)
  560 CONTINUE
      RETURN
      END
