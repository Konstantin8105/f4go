
 INTEGER FUNCTION IDAMAX ( N , DX , INCX )
 INTEGER INCX , N
 DOUBLE PRECISION DX ( * )
 DOUBLE PRECISION DMAX
 INTEGER I , IX
 INTRINSIC DABS
 IDAMAX = 0
 IF ( N .LT. 1 .OR. INCX .LE. 0 ) RETURN
 IDAMAX = 1
 IF ( N .EQ. 1 ) RETURN
 IF ( INCX .EQ. 1 ) THEN
 DMAX = DABS ( DX ( 1 ) )
 DO I = 2 , N
 IF ( DABS ( DX ( I ) ) .GT. DMAX ) THEN
 IDAMAX = I
 DMAX = DABS ( DX ( I ) )
 END IF
 END DO
 ELSE
 IX = 1
 DMAX = DABS ( DX ( 1 ) )
 IX = IX + INCX
 DO I = 2 , N
 IF ( DABS ( DX ( IX ) ) .GT. DMAX ) THEN
 IDAMAX = I
 DMAX = DABS ( DX ( IX ) )
 END IF
 IX = IX + INCX
 END DO
 END IF
 RETURN
 END
