 SUBROUTINE ZHPR ( UPLO , N , ALPHA , X , INCX , AP )
 DOUBLE PRECISION ALPHA
 INTEGER INCX , N
 CHARACTER UPLO
 COMPLEX * 16 AP ( * ) , X ( * )
 COMPLEX * 16 ZERO


 ZERO = ( 0.0D+0 , 0.0D+0 )

 COMPLEX * 16 TEMP
 INTEGER I , INFO , IX , J , JX , K , KK , KX
 LOGICAL LSAME
 EXTERNAL LSAME
 EXTERNAL XERBLA
 INTRINSIC DBLE , DCONJG
 INFO = 0
 IF ( .NOT. LSAME ( UPLO , 'U' ) .AND. .NOT. LSAME ( UPLO , 'L' ) ) THEN
 INFO = 1
 ELSE IF ( N .LT. 0 ) THEN
 INFO = 2
 ELSE IF ( INCX .EQ. 0 ) THEN
 INFO = 5
 END
 IF ( INFO .NE. 0 ) THEN
 CALL XERBLA ( 'ZHPR  ' , INFO )
 RETURN
 END
 IF ( ( N .EQ. 0 ) .OR. ( ALPHA .EQ. DBLE ( ZERO ) ) ) RETURN
 IF ( INCX .LE. 0 ) THEN
 KX = 1 - ( N - 1 ) * INCX
 ELSE IF ( INCX .NE. 1 ) THEN
 KX = 1
 END
 KK = 1
 IF ( LSAME ( UPLO , 'U' ) ) THEN
 IF ( INCX .EQ. 1 ) THEN
 DO J = 1 , N
 IF ( X ( J ) .NE. ZERO ) THEN
 TEMP = ALPHA * DCONJG ( X ( J ) )
 K = KK
 DO I = 1 , J - 1
 AP ( K ) = AP ( K ) + X ( I ) * TEMP
 K = K + 1
 end

 AP ( KK + J - 1 ) = DBLE ( AP ( KK + J - 1 ) ) + DBLE ( X ( J ) * TEMP )
 ELSE
 AP ( KK + J - 1 ) = DBLE ( AP ( KK + J - 1 ) )
 END
 KK = KK + J
 end

 ELSE
 JX = KX
 DO J = 1 , N
 IF ( X ( JX ) .NE. ZERO ) THEN
 TEMP = ALPHA * DCONJG ( X ( JX ) )
 IX = KX
 DO K = KK , KK + J - 2
 AP ( K ) = AP ( K ) + X ( IX ) * TEMP
 IX = IX + INCX
 end

 AP ( KK + J - 1 ) = DBLE ( AP ( KK + J - 1 ) ) + DBLE ( X ( JX ) * TEMP )
 ELSE
 AP ( KK + J - 1 ) = DBLE ( AP ( KK + J - 1 ) )
 END
 JX = JX + INCX
 KK = KK + J
 end

 END
 ELSE
 IF ( INCX .EQ. 1 ) THEN
 DO J = 1 , N
 IF ( X ( J ) .NE. ZERO ) THEN
 TEMP = ALPHA * DCONJG ( X ( J ) )
 AP ( KK ) = DBLE ( AP ( KK ) ) + DBLE ( TEMP * X ( J ) )
 K = KK + 1
 DO I = J + 1 , N
 AP ( K ) = AP ( K ) + X ( I ) * TEMP
 K = K + 1
 end

 ELSE
 AP ( KK ) = DBLE ( AP ( KK ) )
 END
 KK = KK + N - J + 1
 end

 ELSE
 JX = KX
 DO J = 1 , N
 IF ( X ( JX ) .NE. ZERO ) THEN
 TEMP = ALPHA * DCONJG ( X ( JX ) )
 AP ( KK ) = DBLE ( AP ( KK ) ) + DBLE ( TEMP * X ( JX ) )
 IX = JX
 DO K = KK + 1 , KK + N - J
 IX = IX + INCX
 AP ( K ) = AP ( K ) + X ( IX ) * TEMP
 end

 ELSE
 AP ( KK ) = DBLE ( AP ( KK ) )
 END
 JX = JX + INCX
 KK = KK + N - J + 1
 end

 END
 END
 RETURN
 END
