 SUBROUTINE ZROTG ( CA , CB , C , S )
 COMPLEX * 16 CA , CB , S
 DOUBLE PRECISION C
 COMPLEX * 16 ALPHA
 DOUBLE PRECISION NORM , SCALE
 INTRINSIC CDABS , DCMPLX , DCONJG , DSQRT
 IF ( CDABS ( CA ) .EQ. 0.0d0 ) THEN
 C = 0.0d0
 S = ( 1.0d0 , 0.0d0 )
 CA = CB
 ELSE
 SCALE = CDABS ( CA ) + CDABS ( CB )
 NORM = SCALE * DSQRT ( ( CDABS ( CA / DCMPLX ( SCALE , 0.0d0 ) ) ) ** 2 + ( CDABS ( CB / DCMPLX ( SCALE , 0.0d0 ) ) ) ** 2 )
 ALPHA = CA / CDABS ( CA )
 C = CDABS ( CA ) / NORM
 S = ALPHA * DCONJG ( CB ) / NORM
 CA = ALPHA * NORM
 END
 RETURN
 END
