
 INTEGER FUNCTION ISAMAX ( N , SX , INCX )
 INTEGER INCX , N
 REAL SX ( * )
 REAL SMAX
 INTEGER I , IX
 INTRINSIC ABS
 ISAMAX = 0
 IF ( N .LT. 1 .OR. INCX .LE. 0 ) RETURN
 ISAMAX = 1
 IF ( N .EQ. 1 ) RETURN
 IF ( INCX .EQ. 1 ) THEN
 SMAX = ABS ( SX ( 1 ) )
 DO I = 2 , N
 IF ( ABS ( SX ( I ) ) .GT. SMAX ) THEN
 ISAMAX = I
 SMAX = ABS ( SX ( I ) )
 END IF
 END DO
 ELSE
 IX = 1
 SMAX = ABS ( SX ( 1 ) )
 IX = IX + INCX
 DO I = 2 , N
 IF ( ABS ( SX ( IX ) ) .GT. SMAX ) THEN
 ISAMAX = I
 SMAX = ABS ( SX ( IX ) )
 END IF
 IX = IX + INCX
 END DO
 END IF
 RETURN
 END
