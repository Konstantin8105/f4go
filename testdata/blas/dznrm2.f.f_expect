
 DOUBLE PRECISION FUNCTION DZNRM2 ( N , X , INCX )
 INTEGER INCX , N
 COMPLEX * 16 X ( * )
 DOUBLE PRECISION ONE , ZERO
 PARAMETER ( ONE = 1.0D+0 , ZERO = 0.0D+0 )
 DOUBLE PRECISION NORM , SCALE , SSQ , TEMP
 INTEGER IX
 INTRINSIC ABS , DBLE , DIMAG , SQRT
 IF ( N .LT. 1 .OR. INCX .LT. 1 ) THEN
 NORM = ZERO
 ELSE
 SCALE = ZERO
 SSQ = ONE
 DO 10 IX = 1 , 1 + ( N - 1 ) * INCX , INCX
 IF ( DBLE ( X ( IX ) ) .NE. ZERO ) THEN
 TEMP = ABS ( DBLE ( X ( IX ) ) )
 IF ( SCALE .LT. TEMP ) THEN
 SSQ = ONE + SSQ * ( SCALE / TEMP ) ** 2
 SCALE = TEMP
 ELSE
 SSQ = SSQ + ( TEMP / SCALE ) ** 2
 END IF
 END IF
 IF ( DIMAG ( X ( IX ) ) .NE. ZERO ) THEN
 TEMP = ABS ( DIMAG ( X ( IX ) ) )
 IF ( SCALE .LT. TEMP ) THEN
 SSQ = ONE + SSQ * ( SCALE / TEMP ) ** 2
 SCALE = TEMP
 ELSE
 SSQ = SSQ + ( TEMP / SCALE ) ** 2
 END IF
 END IF
 10 CONTINUE
 NORM = SCALE * SQRT ( SSQ )
 END IF
 DZNRM2 = NORM
 RETURN
 END
