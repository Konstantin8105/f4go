 SUBROUTINE DROTM ( N , DX , INCX , DY , INCY , DPARAM )
 INTEGER INCX , INCY , N
 DOUBLE PRECISION DPARAM ( 5 ) , DX ( * ) , DY ( * )
 DOUBLE PRECISION DFLAG , DH11 , DH12 , DH21 , DH22 , TWO , W , Z , ZERO
 INTEGER I , KX , KY , NSTEPS
 DATA ZERO , TWO / 0.D0 , 2.D0 /
 DFLAG = DPARAM ( 1 )
 IF ( N .LE. 0 .OR. ( DFLAG + TWO .EQ. ZERO ) ) RETURN
 IF ( INCX .EQ. INCY .AND. INCX .GT. 0 ) THEN
 NSTEPS = N * INCX
 IF ( DFLAG .LT. ZERO ) THEN
 DH11 = DPARAM ( 2 )
 DH12 = DPARAM ( 4 )
 DH21 = DPARAM ( 3 )
 DH22 = DPARAM ( 5 )
 DO I = 1 , NSTEPS , INCX
 W = DX ( I )
 Z = DY ( I )
 DX ( I ) = W * DH11 + Z * DH12
 DY ( I ) = W * DH21 + Z * DH22
 END
 ELSE IF ( DFLAG .EQ. ZERO ) THEN
 DH12 = DPARAM ( 4 )
 DH21 = DPARAM ( 3 )
 DO I = 1 , NSTEPS , INCX
 W = DX ( I )
 Z = DY ( I )
 DX ( I ) = W + Z * DH12
 DY ( I ) = W * DH21 + Z
 END
 ELSE
 DH11 = DPARAM ( 2 )
 DH22 = DPARAM ( 5 )
 DO I = 1 , NSTEPS , INCX
 W = DX ( I )
 Z = DY ( I )
 DX ( I ) = W * DH11 + Z
 DY ( I ) = - W + DH22 * Z
 END
 END
 ELSE
 KX = 1
 KY = 1
 IF ( INCX .LT. 0 ) KX = 1 + ( 1 - N ) * INCX
 IF ( INCY .LT. 0 ) KY = 1 + ( 1 - N ) * INCY
 IF ( DFLAG .LT. ZERO ) THEN
 DH11 = DPARAM ( 2 )
 DH12 = DPARAM ( 4 )
 DH21 = DPARAM ( 3 )
 DH22 = DPARAM ( 5 )
 DO I = 1 , N
 W = DX ( KX )
 Z = DY ( KY )
 DX ( KX ) = W * DH11 + Z * DH12
 DY ( KY ) = W * DH21 + Z * DH22
 KX = KX + INCX
 KY = KY + INCY
 END
 ELSE IF ( DFLAG .EQ. ZERO ) THEN
 DH12 = DPARAM ( 4 )
 DH21 = DPARAM ( 3 )
 DO I = 1 , N
 W = DX ( KX )
 Z = DY ( KY )
 DX ( KX ) = W + Z * DH12
 DY ( KY ) = W * DH21 + Z
 KX = KX + INCX
 KY = KY + INCY
 END
 ELSE
 DH11 = DPARAM ( 2 )
 DH22 = DPARAM ( 5 )
 DO I = 1 , N
 W = DX ( KX )
 Z = DY ( KY )
 DX ( KX ) = W * DH11 + Z
 DY ( KY ) = - W + DH22 * Z
 KX = KX + INCX
 KY = KY + INCY
 END
 END
 END
 RETURN
 END
