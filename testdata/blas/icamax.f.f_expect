 INTEGER FUNCTION ICAMAX ( N , CX , INCX )
 INTEGER INCX , N
 COMPLEX CX ( * )
 REAL SMAX
 INTEGER I , IX
 REAL SCABS1
 EXTERNAL SCABS1
 ICAMAX = 0
 IF ( N .LT. 1 .OR. INCX .LE. 0 ) RETURN
 ICAMAX = 1
 IF ( N .EQ. 1 ) RETURN
 IF ( INCX .EQ. 1 ) THEN
 SMAX = SCABS1 ( CX ( 1 ) )
 DO I = 2 , N
 IF ( SCABS1 ( CX ( I ) ) .GT. SMAX ) THEN
 ICAMAX = I
 SMAX = SCABS1 ( CX ( I ) )
 END
 END DO
 ELSE
 IX = 1
 SMAX = SCABS1 ( CX ( 1 ) )
 IX = IX + INCX
 DO I = 2 , N
 IF ( SCABS1 ( CX ( IX ) ) .GT. SMAX ) THEN
 ICAMAX = I
 SMAX = SCABS1 ( CX ( IX ) )
 END
 IX = IX + INCX
 END DO
 END
 RETURN
 END
