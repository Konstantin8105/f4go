 SUBROUTINE CTRSM ( SIDE , UPLO , TRANSA , DIAG , M , N , ALPHA , A , LDA , B , LDB )
 COMPLEX ALPHA
 INTEGER LDA , LDB , M , N
 CHARACTER DIAG , SIDE , TRANSA , UPLO
 COMPLEX A ( LDA , * ) , B ( LDB , * )
 LOGICAL LSAME
 EXTERNAL LSAME
 EXTERNAL XERBLA
 INTRINSIC CONJG , MAX
 COMPLEX TEMP
 INTEGER I , INFO , J , K , NROWA
 LOGICAL LSIDE , NOCONJ , NOUNIT , UPPER
 COMPLEX ONE
 PARAMETER ( ONE = ( 1.0E+0 , 0.0E+0 ) )
 COMPLEX ZERO
 PARAMETER ( ZERO = ( 0.0E+0 , 0.0E+0 ) )
 LSIDE = LSAME ( SIDE , 'L' )
 IF ( LSIDE ) THEN
 NROWA = M
 ELSE
 NROWA = N
 END IF
 NOCONJ = LSAME ( TRANSA , 'T' )
 NOUNIT = LSAME ( DIAG , 'N' )
 UPPER = LSAME ( UPLO , 'U' )
 INFO = 0
 IF ( ( .NOT. LSIDE ) .AND. ( .NOT. LSAME ( SIDE , 'R' ) ) ) THEN
 INFO = 1
 ELSE IF ( ( .NOT. UPPER ) .AND. ( .NOT. LSAME ( UPLO , 'L' ) ) ) THEN
 INFO = 2
 ELSE IF ( ( .NOT. LSAME ( TRANSA , 'N' ) ) .AND.
 + ( .NOT. LSAME ( TRANSA , 'T' ) ) .AND.
 + ( .NOT. LSAME ( TRANSA , 'C' ) ) ) THEN
 INFO = 3
 ELSE IF ( ( .NOT. LSAME ( DIAG , 'U' ) ) .AND. ( .NOT. LSAME ( DIAG , 'N' ) ) ) THEN
 INFO = 4
 ELSE IF ( M .LT. 0 ) THEN
 INFO = 5
 ELSE IF ( N .LT. 0 ) THEN
 INFO = 6
 ELSE IF ( LDA .LT. MAX ( 1 , NROWA ) ) THEN
 INFO = 9
 ELSE IF ( LDB .LT. MAX ( 1 , M ) ) THEN
 INFO = 11
 END IF
 IF ( INFO .NE. 0 ) THEN
 CALL XERBLA ( 'CTRSM ' , INFO )
 RETURN
 END IF
 IF ( M .EQ. 0 .OR. N .EQ. 0 ) RETURN
 IF ( ALPHA .EQ. ZERO ) THEN
 DO 20 J = 1 , N
 DO 10 I = 1 , M
 B ( I , J ) = ZERO
 10 CONTINUE
 20 CONTINUE
 RETURN
 END IF
 IF ( LSIDE ) THEN
 IF ( LSAME ( TRANSA , 'N' ) ) THEN
 IF ( UPPER ) THEN
 DO 60 J = 1 , N
 IF ( ALPHA .NE. ONE ) THEN
 DO 30 I = 1 , M
 B ( I , J ) = ALPHA * B ( I , J )
 30 CONTINUE
 END IF
 DO 50 K = M , 1 , - 1
 IF ( B ( K , J ) .NE. ZERO ) THEN
 IF ( NOUNIT ) B ( K , J ) = B ( K , J ) / A ( K , K )
 DO 40 I = 1 , K - 1
 B ( I , J ) = B ( I , J ) - B ( K , J ) * A ( I , K )
 40 CONTINUE
 END IF
 50 CONTINUE
 60 CONTINUE
 ELSE
 DO 100 J = 1 , N
 IF ( ALPHA .NE. ONE ) THEN
 DO 70 I = 1 , M
 B ( I , J ) = ALPHA * B ( I , J )
 70 CONTINUE
 END IF
 DO 90 K = 1 , M
 IF ( B ( K , J ) .NE. ZERO ) THEN
 IF ( NOUNIT ) B ( K , J ) = B ( K , J ) / A ( K , K )
 DO 80 I = K + 1 , M
 B ( I , J ) = B ( I , J ) - B ( K , J ) * A ( I , K )
 80 CONTINUE
 END IF
 90 CONTINUE
 100 CONTINUE
 END IF
 ELSE
 IF ( UPPER ) THEN
 DO 140 J = 1 , N
 DO 130 I = 1 , M
 TEMP = ALPHA * B ( I , J )
 IF ( NOCONJ ) THEN
 DO 110 K = 1 , I - 1
 TEMP = TEMP - A ( K , I ) * B ( K , J )
 110 CONTINUE
 IF ( NOUNIT ) TEMP = TEMP / A ( I , I )
 ELSE
 DO 120 K = 1 , I - 1
 TEMP = TEMP - CONJG ( A ( K , I ) ) * B ( K , J )
 120 CONTINUE
 IF ( NOUNIT ) TEMP = TEMP / CONJG ( A ( I , I ) )
 END IF
 B ( I , J ) = TEMP
 130 CONTINUE
 140 CONTINUE
 ELSE
 DO 180 J = 1 , N
 DO 170 I = M , 1 , - 1
 TEMP = ALPHA * B ( I , J )
 IF ( NOCONJ ) THEN
 DO 150 K = I + 1 , M
 TEMP = TEMP - A ( K , I ) * B ( K , J )
 150 CONTINUE
 IF ( NOUNIT ) TEMP = TEMP / A ( I , I )
 ELSE
 DO 160 K = I + 1 , M
 TEMP = TEMP - CONJG ( A ( K , I ) ) * B ( K , J )
 160 CONTINUE
 IF ( NOUNIT ) TEMP = TEMP / CONJG ( A ( I , I ) )
 END IF
 B ( I , J ) = TEMP
 170 CONTINUE
 180 CONTINUE
 END IF
 END IF
 ELSE
 IF ( LSAME ( TRANSA , 'N' ) ) THEN
 IF ( UPPER ) THEN
 DO 230 J = 1 , N
 IF ( ALPHA .NE. ONE ) THEN
 DO 190 I = 1 , M
 B ( I , J ) = ALPHA * B ( I , J )
 190 CONTINUE
 END IF
 DO 210 K = 1 , J - 1
 IF ( A ( K , J ) .NE. ZERO ) THEN
 DO 200 I = 1 , M
 B ( I , J ) = B ( I , J ) - A ( K , J ) * B ( I , K )
 200 CONTINUE
 END IF
 210 CONTINUE
 IF ( NOUNIT ) THEN
 TEMP = ONE / A ( J , J )
 DO 220 I = 1 , M
 B ( I , J ) = TEMP * B ( I , J )
 220 CONTINUE
 END IF
 230 CONTINUE
 ELSE
 DO 280 J = N , 1 , - 1
 IF ( ALPHA .NE. ONE ) THEN
 DO 240 I = 1 , M
 B ( I , J ) = ALPHA * B ( I , J )
 240 CONTINUE
 END IF
 DO 260 K = J + 1 , N
 IF ( A ( K , J ) .NE. ZERO ) THEN
 DO 250 I = 1 , M
 B ( I , J ) = B ( I , J ) - A ( K , J ) * B ( I , K )
 250 CONTINUE
 END IF
 260 CONTINUE
 IF ( NOUNIT ) THEN
 TEMP = ONE / A ( J , J )
 DO 270 I = 1 , M
 B ( I , J ) = TEMP * B ( I , J )
 270 CONTINUE
 END IF
 280 CONTINUE
 END IF
 ELSE
 IF ( UPPER ) THEN
 DO 330 K = N , 1 , - 1
 IF ( NOUNIT ) THEN
 IF ( NOCONJ ) THEN
 TEMP = ONE / A ( K , K )
 ELSE
 TEMP = ONE / CONJG ( A ( K , K ) )
 END IF
 DO 290 I = 1 , M
 B ( I , K ) = TEMP * B ( I , K )
 290 CONTINUE
 END IF
 DO 310 J = 1 , K - 1
 IF ( A ( J , K ) .NE. ZERO ) THEN
 IF ( NOCONJ ) THEN
 TEMP = A ( J , K )
 ELSE
 TEMP = CONJG ( A ( J , K ) )
 END IF
 DO 300 I = 1 , M
 B ( I , J ) = B ( I , J ) - TEMP * B ( I , K )
 300 CONTINUE
 END IF
 310 CONTINUE
 IF ( ALPHA .NE. ONE ) THEN
 DO 320 I = 1 , M
 B ( I , K ) = ALPHA * B ( I , K )
 320 CONTINUE
 END IF
 330 CONTINUE
 ELSE
 DO 380 K = 1 , N
 IF ( NOUNIT ) THEN
 IF ( NOCONJ ) THEN
 TEMP = ONE / A ( K , K )
 ELSE
 TEMP = ONE / CONJG ( A ( K , K ) )
 END IF
 DO 340 I = 1 , M
 B ( I , K ) = TEMP * B ( I , K )
 340 CONTINUE
 END IF
 DO 360 J = K + 1 , N
 IF ( A ( J , K ) .NE. ZERO ) THEN
 IF ( NOCONJ ) THEN
 TEMP = A ( J , K )
 ELSE
 TEMP = CONJG ( A ( J , K ) )
 END IF
 DO 350 I = 1 , M
 B ( I , J ) = B ( I , J ) - TEMP * B ( I , K )
 350 CONTINUE
 END IF
 360 CONTINUE
 IF ( ALPHA .NE. ONE ) THEN
 DO 370 I = 1 , M
 B ( I , K ) = ALPHA * B ( I , K )
 370 CONTINUE
 END IF
 380 CONTINUE
 END IF
 END IF
 END IF
 RETURN
 END
