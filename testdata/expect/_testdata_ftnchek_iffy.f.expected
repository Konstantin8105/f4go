token(96)           	SUBROUTINE
IDENT               	IFFY
(                   	(
IDENT               	USE1
,                   	,
IDENT               	USE2
,                   	,
IDENT               	L
)                   	)
COMMENT             	* Tests parsing & type-checking of various IF forms.
COMMENT             	*
IDENT               	LOGICAL
IDENT               	USE1
,                   	,
IDENT               	USE2
token(98)           	INTEGER
IDENT               	L
token(98)           	INTEGER
IDENT               	M
IDENT               	REAL
IDENT               	X
COMMENT             	* this block-if statement is OK
if                  	IF
(                   	(
IDENT               	USE1
)                   	)
token(106)          	THEN
IDENT               	M
=                   	=
INT                 	1
COMMENT             	* else-if statement is OK
else                	ELSE
if                  	IF
(                   	(
IDENT               	USE2
)                   	)
token(106)          	THEN
IDENT               	M
=                   	=
INT                 	2
else                	ELSE
IDENT               	M
=                   	=
INT                 	3
token(102)          	END
if                  	IF
COMMENT             	* this logical if is OK
if                  	IF
(                   	(
IDENT               	M
==                  	.eq.
INT                 	3
)                   	)
IDENT               	L
=                   	=
IDENT               	L
+                   	+
INT                 	1
COMMENT             	* this arithmetic if is OK
if                  	IF
(                   	(
IDENT               	L
)                   	)
INT                 	100
,                   	,
INT                 	100
,                   	,
INT                 	100
INT                 	100
IDENT               	X
=                   	=
IDENT               	L
COMMENT             	* this arithmetic if is OK
if                  	IF
(                   	(
IDENT               	X
)                   	)
INT                 	150
,                   	,
INT                 	150
,                   	,
INT                 	150
INT                 	150
continue            	CONTINUE
COMMENT             	* violate a block if statement
if                  	IF
(                   	(
IDENT               	L
)                   	)
token(106)          	THEN
IDENT               	M
=                   	=
IDENT               	M
+                   	+
INT                 	1
COMMENT             	* violate an elseif statement
else                	ELSE
if                  	IF
(                   	(
IDENT               	M
)                   	)
token(106)          	THEN
IDENT               	M
=                   	=
IDENT               	M
+                   	+
INT                 	2
else                	ELSE
IDENT               	M
=                   	=
IDENT               	M
+                   	+
INT                 	3
token(102)          	END
if                  	IF
COMMENT             	* violate a logical if statement
if                  	IF
(                   	(
IDENT               	M
)                   	)
IDENT               	L
=                   	=
IDENT               	L
+                   	+
INT                 	1
COMMENT             	* violate an arithmetic if statement
if                  	IF
(                   	(
IDENT               	L
==                  	.EQ.
INT                 	3
)                   	)
INT                 	200
,                   	,
INT                 	200
,                   	,
INT                 	200
INT                 	200
continue            	CONTINUE
token(102)          	END
