token(96)           	SUBROUTINE
IDENT               	IFFY
(                   	(
IDENT               	USE1
,                   	,
IDENT               	USE2
,                   	,
IDENT               	L
)                   	)
COMMENT             	* Tests parsing & type-checking of various IF forms.
COMMENT             	*
IDENT               	LOGICAL
IDENT               	USE1
,                   	,
IDENT               	USE2
token(98)           	INTEGER
IDENT               	L
token(98)           	INTEGER
IDENT               	M
IDENT               	REAL
IDENT               	X
COMMENT             	* this block-if statement is OK
if                  	IF
(                   	(
IDENT               	USE1
)                   	)
IDENT               	THEN
IDENT               	M
=                   	=
IDENT               	1
COMMENT             	* else-if statement is OK
else                	ELSE
if                  	IF
(                   	(
IDENT               	USE2
)                   	)
IDENT               	THEN
IDENT               	M
=                   	=
IDENT               	2
else                	ELSE
IDENT               	M
=                   	=
IDENT               	3
IDENT               	END
if                  	IF
COMMENT             	* this logical if is OK
if                  	IF
(                   	(
IDENT               	M
.                   	.
IDENT               	eq
.                   	.
IDENT               	3
)                   	)
IDENT               	L
=                   	=
IDENT               	L
+                   	+
IDENT               	1
COMMENT             	* this arithmetic if is OK
if                  	IF
(                   	(
IDENT               	L
)                   	)
IDENT               	100
,                   	,
IDENT               	100
,                   	,
IDENT               	100
IDENT               	100
IDENT               	X
=                   	=
IDENT               	L
COMMENT             	* this arithmetic if is OK
if                  	IF
(                   	(
IDENT               	X
)                   	)
IDENT               	150
,                   	,
IDENT               	150
,                   	,
IDENT               	150
IDENT               	150
IDENT               	CONTINUE
COMMENT             	* violate a block if statement
if                  	IF
(                   	(
IDENT               	L
)                   	)
IDENT               	THEN
IDENT               	M
=                   	=
IDENT               	M
+                   	+
IDENT               	1
COMMENT             	* violate an elseif statement
else                	ELSE
if                  	IF
(                   	(
IDENT               	M
)                   	)
IDENT               	THEN
IDENT               	M
=                   	=
IDENT               	M
+                   	+
IDENT               	2
else                	ELSE
IDENT               	M
=                   	=
IDENT               	M
+                   	+
IDENT               	3
IDENT               	END
if                  	IF
COMMENT             	* violate a logical if statement
if                  	IF
(                   	(
IDENT               	M
)                   	)
IDENT               	L
=                   	=
IDENT               	L
+                   	+
IDENT               	1
COMMENT             	* violate an arithmetic if statement
if                  	IF
(                   	(
IDENT               	L
.                   	.
IDENT               	EQ
.                   	.
IDENT               	3
)                   	)
IDENT               	200
,                   	,
IDENT               	200
,                   	,
IDENT               	200
IDENT               	200
IDENT               	CONTINUE
IDENT               	END
