COMMENT             	C  Derived from Brian Downing's WC program, replacing common decls by INCLUDEs
COMMENT             	C
COMMENT             	C     main(){   Get a file, open it, read and determine semi-useful
COMMENT             	C               statistics, print them to screen, and exit quietly.
COMMENT             	C           };
COMMENT             	C
COMMENT             	C     This program is an example word counter that makes use of several
COMMENT             	C     Fortran intrinsic functions and data structures, such as; 
COMMENT             	C     common, sub-routines, functions, inplied do loops, and much, much more.
COMMENT             	C
token(97)           	Program
IDENT               	WC
COMMENT             	CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
COMMENT             	C     Program:    Word_Count_And_Other_Stuff                                 C
COMMENT             	C     Written_By: Brian Downing                                              C
COMMENT             	C                 Fordham University                                         C
COMMENT             	C     Date:       October 1st-16th, 1990                                     C
COMMENT             	CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
IDENT               	Character
IDENT               	Fname
*                   	*
INT                 	80
token(105)          	Call
IDENT               	Initialize
token(105)          	Call
IDENT               	GetFileName
(                   	(
IDENT               	Fname
)                   	)
token(105)          	Call
IDENT               	GetStats
(                   	(
IDENT               	Fname
)                   	)
token(105)          	Call
IDENT               	PrintStats
token(102)          	End
COMMENT             	C
COMMENT             	C     SubRoutine to get all kinds of neat statistics.
COMMENT             	C
token(96)           	SubRoutine
IDENT               	GetStats
(                   	(
IDENT               	Fname
)                   	)
IDENT               	Include
STRING              	'stats.h'
IDENT               	Character
IDENT               	Inline
*                   	*
INT                 	82
,                   	,
IDENT               	Fname
*                   	*
INT                 	80
,                   	,
IDENT               	Ch
IDENT               	Open
(                   	(
IDENT               	Unit
=                   	=
INT                 	8
,                   	,
IDENT               	File
=                   	=
IDENT               	Fname
,                   	,
IDENT               	Err
=                   	=
INT                 	999
)                   	)
token(103)          	Do
IDENT               	While
(                   	(
IDENT               	.TRUE.
)                   	)
IDENT               	Read
(                   	(
INT                 	8
,                   	,
INT                 	10
,                   	,
token(102)          	End
=                   	=
INT                 	888
)                   	)
IDENT               	InLine
IDENT               	NL
=                   	=
IDENT               	NL
+                   	+
INT                 	1
IDENT               	LastPos
=                   	=
IDENT               	INDEX
(                   	(
IDENT               	InLine
,                   	,
STRING              	'  '
)                   	)
token(103)          	Do
IDENT               	J
=                   	=
INT                 	1
,                   	,
IDENT               	LastPos
IDENT               	Ch
=                   	=
IDENT               	InLine
(                   	(
IDENT               	J
:                   	:
IDENT               	J
)                   	)
IDENT               	L
=                   	=
IDENT               	IntUpCase
(                   	(
IDENT               	ICHAR
(                   	(
IDENT               	Ch
)                   	)
)                   	)
IDENT               	NEC
(                   	(
IDENT               	L
)                   	)
=                   	=
IDENT               	NEC
(                   	(
IDENT               	L
)                   	)
+                   	+
INT                 	1
if                  	If
(                   	(
(                   	(
IDENT               	Ch
!=                  	.NE.
STRING              	' '
)                   	)
&&                  	.AND.
(                   	(
IDENT               	Ch
!=                  	.NE.
STRING              	'.'
)                   	)
)                   	)
IDENT               	Then
IDENT               	NC
=                   	=
IDENT               	NC
+                   	+
INT                 	1
IDENT               	ElseIf
(                   	(
IDENT               	Ch
==                  	.EQ.
STRING              	'.'
)                   	)
IDENT               	Then
IDENT               	NP
=                   	=
IDENT               	NP
+                   	+
INT                 	1
else                	Else
IDENT               	NW
=                   	=
IDENT               	NW
+                   	+
INT                 	1
IDENT               	EndIf
token(104)          	EndDo
token(104)          	EndDo
INT                 	888
continue            	Continue
IDENT               	ACPW
=                   	=
IDENT               	REAL
(                   	(
IDENT               	NC
)                   	)
/                   	/
IDENT               	REAL
(                   	(
IDENT               	NW
)                   	)
IDENT               	AWPS
=                   	=
IDENT               	REAL
(                   	(
IDENT               	NW
)                   	)
/                   	/
IDENT               	REAL
(                   	(
IDENT               	NP
)                   	)
IDENT               	Return
INT                 	10
IDENT               	Format
(                   	(
IDENT               	a
)                   	)
INT                 	999
IDENT               	Print
*                   	*
,                   	,
STRING              	'Error opening file, please verify filename and try again.'
COMMENT             	C
COMMENT             	C     In the event of improper filename exit abruptly.
COMMENT             	C
IDENT               	STOP
token(102)          	End
COMMENT             	C
COMMENT             	C     SubRoutine to print to terminal all of these neat statistics.
COMMENT             	C
token(96)           	SubRoutine
IDENT               	PrintStats
IDENT               	Include
STRING              	'stats.h'
IDENT               	Write
(                   	(
INT                 	5
,                   	,
INT                 	10
)                   	)
IDENT               	ACPW
,                   	,
IDENT               	AWPS
,                   	,
IDENT               	NW
,                   	,
IDENT               	NP
,                   	,
IDENT               	NL
,                   	,
IDENT               	NC
IDENT               	Write
(                   	(
INT                 	5
,                   	,
INT                 	20
)                   	)
token(103)          	Do
IDENT               	J
=                   	=
INT                 	65
,                   	,
INT                 	90
IDENT               	Write
(                   	(
INT                 	5
,                   	,
INT                 	40
)                   	)
(                   	(
IDENT               	CHAR
(                   	(
IDENT               	J
)                   	)
,                   	,
IDENT               	NEC
(                   	(
IDENT               	J
)                   	)
,                   	,
(                   	(
STRING              	'@'
,                   	,
IDENT               	K
=                   	=
INT                 	1
,                   	,
(                   	(
IDENT               	NEC
(                   	(
IDENT               	J
)                   	)
/                   	/
INT                 	10
)                   	)
)                   	)
,                   	,
INT                 	1
(                   	(
STRING              	'*'
,                   	,
IDENT               	K
=                   	=
INT                 	1
,                   	,
IDENT               	MOD
(                   	(
IDENT               	NEC
(                   	(
IDENT               	J
)                   	)
,                   	,
INT                 	10
)                   	)
)                   	)
)                   	)
token(104)          	EndDo
IDENT               	Write
(                   	(
INT                 	5
,                   	,
INT                 	50
)                   	)
INT                 	10
IDENT               	Format
(                   	(
STRING              	'1'
INT                 	30
IDENT               	X
STRING              	'Word Statistics'
/                   	/
INT                 	1
IDENT               	x
,                   	,
INT                 	80
(                   	(
STRING              	'*'
)                   	)
/                   	/
INT                 	1
INT                 	1
IDENT               	X
STRING              	'Average characters per word = '
IDENT               	F6
.                   	.
INT                 	2
INT                 	1
IDENT               	X
STRING              	'Average words per sentence  = '
IDENT               	F6
.                   	.
INT                 	3
INT                 	1
IDENT               	X
STRING              	'Total number of words       = '
IDENT               	I5
/                   	/
INT                 	4
INT                 	1
IDENT               	X
STRING              	'Total number of sentences   = '
IDENT               	I5
/                   	/
INT                 	5
INT                 	1
IDENT               	X
STRING              	'Total number of lines       = '
IDENT               	I5
/                   	/
INT                 	6
INT                 	1
IDENT               	X
STRING              	'Total number of characters  = '
IDENT               	I5
/                   	/
)                   	)
INT                 	20
IDENT               	Format
(                   	(
INT                 	29
IDENT               	x
STRING              	'Character Statistics'
/                   	/
INT                 	1
IDENT               	x
,                   	,
INT                 	80
(                   	(
STRING              	'*'
)                   	)
/                   	/
)                   	)
INT                 	30
IDENT               	Format
(                   	(
INT                 	1
IDENT               	X
,                   	,
IDENT               	A
)                   	)
INT                 	40
IDENT               	Format
(                   	(
INT                 	1
IDENT               	X
,                   	,
IDENT               	A
STRING              	','
IDENT               	I3
,                   	,
INT                 	1
IDENT               	x
,                   	,
INT                 	125
(                   	(
IDENT               	A
)                   	)
)                   	)
INT                 	50
IDENT               	Format
(                   	(
INT                 	1
IDENT               	X
STRING              	'Legend:'
/                   	/
INT                 	9
IDENT               	x
STRING              	'@ equals ten characters'
,                   	,
INT                 	1
STRING              	', * equals one character.'
)                   	)
IDENT               	Return
token(102)          	End
COMMENT             	C
COMMENT             	C     SubRoutine to prompt for and return a filename.
COMMENT             	C
token(96)           	SubRoutine
IDENT               	GetFileName
(                   	(
IDENT               	Fname
)                   	)
IDENT               	Character
IDENT               	Fname
*                   	*
INT                 	80
,                   	,
IDENT               	Prompt
*                   	*
INT                 	7
IDENT               	Prompt
=                   	=
STRING              	'_File: '
IDENT               	Write
(                   	(
INT                 	5
,                   	,
INT                 	10
)                   	)
IDENT               	Prompt
IDENT               	Read
(                   	(
INT                 	5
,                   	,
INT                 	20
)                   	)
IDENT               	Fname
INT                 	10
IDENT               	Format
(                   	(
INT                 	1
IDENT               	XA
)                   	)
INT                 	20
IDENT               	Format
(                   	(
IDENT               	A
)                   	)
IDENT               	Return
token(102)          	End
COMMENT             	C
COMMENT             	C     SubRoutine to initailize globally used variables.
COMMENT             	C
token(96)           	SubRoutine
IDENT               	Initialize
IDENT               	Common
/                   	/
IDENT               	Stats
/                   	/
IDENT               	A
,                   	,
IDENT               	B
,                   	,
IDENT               	J
,                   	,
IDENT               	K
,                   	,
IDENT               	L
,                   	,
IDENT               	M
,                   	,
IDENT               	N
(                   	(
INT                 	26
)                   	)
token(103)          	Do
IDENT               	O
=                   	=
INT                 	1
,                   	,
INT                 	26
IDENT               	N
(                   	(
IDENT               	O
)                   	)
=                   	=
INT                 	0
token(104)          	EndDo
IDENT               	A
=                   	=
FLOAT               	0.0
IDENT               	B
=                   	=
FLOAT               	0.0
IDENT               	J
=                   	=
INT                 	0
IDENT               	K
=                   	=
INT                 	0
IDENT               	L
=                   	=
INT                 	0
IDENT               	M
=                   	=
INT                 	0
IDENT               	Return
token(102)          	End
COMMENT             	C
COMMENT             	C     Function to return integer value of a character in range of uppercase.
COMMENT             	C
token(101)          	Function
IDENT               	IntUpCase
(                   	(
IDENT               	I
)                   	)
if                  	If
(                   	(
(                   	(
IDENT               	I
<=                  	.LE.
IDENT               	ICHAR
(                   	(
STRING              	'z'
)                   	)
)                   	)
&&                  	.AND.
(                   	(
IDENT               	I
>=                  	.GE.
IDENT               	ICHAR
(                   	(
STRING              	'a'
)                   	)
)                   	)
)                   	)
IDENT               	Then
IDENT               	IntUpCase
=                   	=
IDENT               	I
-                   	-
IDENT               	ICHAR
(                   	(
STRING              	' '
)                   	)
else                	Else
IDENT               	IntUpCase
=                   	=
IDENT               	I
IDENT               	EndIf
IDENT               	Return
token(102)          	End
