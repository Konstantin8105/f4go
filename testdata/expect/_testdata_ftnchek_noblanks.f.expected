IDENT               	doubleprecisionfunctiondnrm2
(                   	(
IDENT               	n
,                   	,
IDENT               	dx
,                   	,
IDENT               	incx
)                   	)
IDENT               	integernext
IDENT               	doubleprecisiondx
(                   	(
IDENT               	1
)                   	)
,                   	,
IDENT               	cutlo
,                   	,
IDENT               	cuthi
,                   	,
IDENT               	hitest
,                   	,
IDENT               	sum
,                   	,
IDENT               	xmax
,                   	,
IDENT               	zero
,                   	,
IDENT               	one
IDENT               	datazero
,                   	,
IDENT               	one
/                   	/
IDENT               	0
.                   	.
IDENT               	0
IDENT               	d0
,                   	,
IDENT               	1
.                   	.
IDENT               	0
IDENT               	d0
/                   	/
COMMENT             	c
COMMENT             	c     euclideannormofthen-vectorstoredindx()withstorage
COMMENT             	c     incrementincx.
COMMENT             	c     ifn.le.0returnwithresult=0.
COMMENT             	c     ifn.ge.1thenincxmustbe.ge.1
COMMENT             	c
COMMENT             	c     c.l.lawson,1978jan08
COMMENT             	c
COMMENT             	c     fourphasemethodusingtwobuilt-inconstantsthatare
COMMENT             	c     hopefullyapplicabletoallmachines.
COMMENT             	c     cutlo=maximumofdsqrt(u/eps)overallknownmachines.
COMMENT             	c     cuthi=minimumofdsqrt(v)overallknownmachines.
COMMENT             	c     where
COMMENT             	c     eps=smallestno.suchthateps+1..gt.1.
COMMENT             	c     u=smallestpositiveno.(underflowlimit)
COMMENT             	c     v=largestno.(overflowlimit)
COMMENT             	c
COMMENT             	c     briefoutlineofalgorithm..
COMMENT             	c
COMMENT             	c     phase1scanszerocomponents.
COMMENT             	c     movetophase2whenacomponentisnonzeroand.le.cutlo
COMMENT             	c     movetophase3whenacomponentis.gt.cutlo
COMMENT             	c     movetophase4whenacomponentis.ge.cuthi/m
COMMENT             	c     wherem=nforx()realandm=2*nforcomplex.
COMMENT             	c
COMMENT             	c     valuesforcutloandcuthi..
COMMENT             	c     fromtheenvironmentalparameterslistedintheimslconverter
COMMENT             	c     documentthelimitingvaluesareasfollows..
COMMENT             	c     cutlo,s.p.u/eps=2**(-102)forhoneywell.closesecondsare
COMMENT             	c     univacanddecat2**(-103)
COMMENT             	c     thuscutlo=2**(-51)=4.44089e-16
COMMENT             	c     cuthi,s.p.v=2**127forunivac,honeywell,anddec.
COMMENT             	c     thuscuthi=2**(63.5)=1.30438e19
COMMENT             	c     cutlo,d.p.u/eps=2**(-67)forhoneywellanddec.
COMMENT             	c     thuscutlo=2**(-33.5)=8.23181d-11
COMMENT             	c     cuthi,d.p.sameass.p.cuthi=1.30438d19
COMMENT             	c     datacutlo,cuthi/8.232d-11,1.304d19/
COMMENT             	c     datacutlo,cuthi/4.441e-16,1.304e19/
IDENT               	datacutlo
,                   	,
IDENT               	cuthi
/                   	/
IDENT               	8
.                   	.
IDENT               	232
IDENT               	d
-                   	-
IDENT               	11
,                   	,
IDENT               	1
.                   	.
IDENT               	304
IDENT               	d19
/                   	/
COMMENT             	c
if                  	if
(                   	(
IDENT               	n
.                   	.
IDENT               	gt
.                   	.
IDENT               	0
)                   	)
IDENT               	goto10
IDENT               	dnrm2
=                   	=
IDENT               	zero
IDENT               	goto300
COMMENT             	c
IDENT               	10
IDENT               	assign30tonext
IDENT               	sum
=                   	=
IDENT               	zero
IDENT               	nn
=                   	=
IDENT               	n
*                   	*
IDENT               	incx
COMMENT             	c     beginmainloop
IDENT               	i
=                   	=
IDENT               	1
IDENT               	20
IDENT               	gotonext
,                   	,
(                   	(
IDENT               	30
,                   	,
IDENT               	50
,                   	,
IDENT               	70
,                   	,
IDENT               	110
)                   	)
IDENT               	30
if                  	if
(                   	(
IDENT               	dabs
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
.                   	.
IDENT               	gt
.                   	.
IDENT               	cutlo
)                   	)
IDENT               	goto85
IDENT               	assign50tonext
IDENT               	xmax
=                   	=
IDENT               	zero
COMMENT             	c
COMMENT             	c     phase1.sumiszero
COMMENT             	c
IDENT               	50
if                  	if
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
.                   	.
IDENT               	eq
.                   	.
IDENT               	zero
)                   	)
IDENT               	goto200
if                  	if
(                   	(
IDENT               	dabs
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
.                   	.
IDENT               	gt
.                   	.
IDENT               	cutlo
)                   	)
IDENT               	goto85
COMMENT             	c
COMMENT             	c     prepareforphase2.
IDENT               	assign70tonext
IDENT               	goto105
COMMENT             	c
COMMENT             	c     prepareforphase4.
COMMENT             	c
IDENT               	100
IDENT               	i
=                   	=
IDENT               	j
IDENT               	assign110tonext
IDENT               	sum
=                   	=
(                   	(
IDENT               	sum
/                   	/
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
/                   	/
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
IDENT               	105
IDENT               	xmax
=                   	=
IDENT               	dabs
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
IDENT               	goto115
COMMENT             	c
COMMENT             	c     phase2.sumissmall.
COMMENT             	c     scaletoavoiddestructiveunderflow.
COMMENT             	c
IDENT               	70
if                  	if
(                   	(
IDENT               	dabs
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
.                   	.
IDENT               	gt
.                   	.
IDENT               	cutlo
)                   	)
IDENT               	goto75
COMMENT             	c
COMMENT             	c     commoncodeforphases2and4.
COMMENT             	c     inphase4sumislarge.scaletoavoidoverflow.
COMMENT             	c
IDENT               	110
if                  	if
(                   	(
IDENT               	dabs
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
.                   	.
IDENT               	le
.                   	.
IDENT               	xmax
)                   	)
IDENT               	goto115
IDENT               	sum
=                   	=
IDENT               	one
+                   	+
IDENT               	sum
*                   	*
(                   	(
IDENT               	xmax
/                   	/
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
token(95)           	**
IDENT               	2
IDENT               	xmax
=                   	=
IDENT               	dabs
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
IDENT               	goto200
COMMENT             	c
IDENT               	115
IDENT               	sum
=                   	=
IDENT               	sum
+                   	+
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
/                   	/
IDENT               	xmax
)                   	)
token(95)           	**
IDENT               	2
IDENT               	goto200
COMMENT             	c
COMMENT             	c
COMMENT             	c     prepareforphase3.
COMMENT             	c
IDENT               	75
IDENT               	sum
=                   	=
(                   	(
IDENT               	sum
*                   	*
IDENT               	xmax
)                   	)
*                   	*
IDENT               	xmax
COMMENT             	c
COMMENT             	c
COMMENT             	c     forrealord.p.sethitest=cuthi/n
COMMENT             	c     forcomplexsethitest=cuthi/(2*n)
COMMENT             	c
IDENT               	85
IDENT               	hitest
=                   	=
IDENT               	cuthi
/                   	/
IDENT               	float
(                   	(
IDENT               	n
)                   	)
COMMENT             	c
COMMENT             	c     phase3.sumismid-range.noscaling.
COMMENT             	c
IDENT               	do95j
=                   	=
IDENT               	i
,                   	,
IDENT               	nn
,                   	,
IDENT               	incx
if                  	if
(                   	(
IDENT               	dabs
(                   	(
IDENT               	dx
(                   	(
IDENT               	j
)                   	)
)                   	)
.                   	.
IDENT               	ge
.                   	.
IDENT               	hitest
)                   	)
IDENT               	goto100
IDENT               	95
IDENT               	sum
=                   	=
IDENT               	sum
+                   	+
IDENT               	dx
(                   	(
IDENT               	j
)                   	)
token(95)           	**
IDENT               	2
IDENT               	dnrm2
=                   	=
IDENT               	dsqrt
(                   	(
IDENT               	sum
)                   	)
IDENT               	goto300
COMMENT             	c
IDENT               	200
IDENT               	continue
IDENT               	i
=                   	=
IDENT               	i
+                   	+
IDENT               	incx
if                  	if
(                   	(
IDENT               	i
.                   	.
IDENT               	le
.                   	.
IDENT               	nn
)                   	)
IDENT               	goto20
COMMENT             	c
COMMENT             	c     endofmainloop.
COMMENT             	c
COMMENT             	c     computesquarerootandadjustforscaling.
COMMENT             	c
IDENT               	dnrm2
=                   	=
IDENT               	xmax
*                   	*
IDENT               	dsqrt
(                   	(
IDENT               	sum
)                   	)
IDENT               	300
IDENT               	continue
IDENT               	return
token(102)          	end
