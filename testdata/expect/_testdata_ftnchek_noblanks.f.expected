IDENT               	doubleprecisionfunctiondnrm2
(                   	(
IDENT               	n
,                   	,
IDENT               	dx
,                   	,
IDENT               	incx
)                   	)
IDENT               	integernext
IDENT               	doubleprecisiondx
(                   	(
IDENT               	1
)                   	)
,                   	,
IDENT               	cutlo
,                   	,
IDENT               	cuthi
,                   	,
IDENT               	hitest
,                   	,
IDENT               	sum
,                   	,
IDENT               	xmax
,                   	,
IDENT               	zero
,                   	,
IDENT               	one
IDENT               	datazero
,                   	,
IDENT               	one
/                   	/
IDENT               	0
.                   	.
IDENT               	0
IDENT               	d0
,                   	,
IDENT               	1
.                   	.
IDENT               	0
IDENT               	d0
/                   	/
IDENT               	c
IDENT               	c
IDENT               	euclideannormofthen
-                   	-
IDENT               	vectorstoredindx
(                   	(
)                   	)
IDENT               	withstorage
IDENT               	c
IDENT               	incrementincx
.                   	.
IDENT               	c
IDENT               	ifn
.                   	.
IDENT               	le
.                   	.
IDENT               	0
IDENT               	returnwithresult
=                   	=
IDENT               	0
.                   	.
IDENT               	c
IDENT               	ifn
.                   	.
IDENT               	ge
.                   	.
IDENT               	1
IDENT               	thenincxmustbe
.                   	.
IDENT               	ge
.                   	.
IDENT               	1
IDENT               	c
IDENT               	c
IDENT               	c
.                   	.
IDENT               	l
.                   	.
IDENT               	lawson
,                   	,
IDENT               	1978
IDENT               	jan08
IDENT               	c
IDENT               	c
IDENT               	fourphasemethodusingtwobuilt
-                   	-
IDENT               	inconstantsthatare
IDENT               	c
IDENT               	hopefullyapplicabletoallmachines
.                   	.
IDENT               	c
IDENT               	cutlo
=                   	=
IDENT               	maximumofdsqrt
(                   	(
IDENT               	u
/                   	/
IDENT               	eps
)                   	)
IDENT               	overallknownmachines
.                   	.
IDENT               	c
IDENT               	cuthi
=                   	=
IDENT               	minimumofdsqrt
(                   	(
IDENT               	v
)                   	)
IDENT               	overallknownmachines
.                   	.
IDENT               	c
IDENT               	where
IDENT               	c
IDENT               	eps
=                   	=
IDENT               	smallestno
.                   	.
IDENT               	suchthateps
+                   	+
IDENT               	1
.                   	.
.                   	.
IDENT               	gt
.                   	.
IDENT               	1
.                   	.
IDENT               	c
IDENT               	u
=                   	=
IDENT               	smallestpositiveno
.                   	.
(                   	(
IDENT               	underflowlimit
)                   	)
IDENT               	c
IDENT               	v
=                   	=
IDENT               	largestno
.                   	.
(                   	(
IDENT               	overflowlimit
)                   	)
IDENT               	c
IDENT               	c
IDENT               	briefoutlineofalgorithm
.                   	.
.                   	.
IDENT               	c
IDENT               	c
IDENT               	phase1scanszerocomponents
.                   	.
IDENT               	c
IDENT               	movetophase2whenacomponentisnonzeroand
.                   	.
IDENT               	le
.                   	.
IDENT               	cutlo
IDENT               	c
IDENT               	movetophase3whenacomponentis
.                   	.
IDENT               	gt
.                   	.
IDENT               	cutlo
IDENT               	c
IDENT               	movetophase4whenacomponentis
.                   	.
IDENT               	ge
.                   	.
IDENT               	cuthi
/                   	/
IDENT               	m
IDENT               	c
IDENT               	wherem
=                   	=
IDENT               	nforx
(                   	(
)                   	)
IDENT               	realandm
=                   	=
IDENT               	2
*                   	*
IDENT               	nforcomplex
.                   	.
IDENT               	c
IDENT               	c
IDENT               	valuesforcutloandcuthi
.                   	.
.                   	.
IDENT               	c
IDENT               	fromtheenvironmentalparameterslistedintheimslconverter
IDENT               	c
IDENT               	documentthelimitingvaluesareasfollows
.                   	.
.                   	.
IDENT               	c
IDENT               	cutlo
,                   	,
IDENT               	s
.                   	.
IDENT               	p
.                   	.
IDENT               	u
/                   	/
IDENT               	eps
=                   	=
IDENT               	2
token(95)           	**
(                   	(
-                   	-
IDENT               	102
)                   	)
IDENT               	forhoneywell
.                   	.
IDENT               	closesecondsare
IDENT               	c
IDENT               	univacanddecat2
token(95)           	**
(                   	(
-                   	-
IDENT               	103
)                   	)
IDENT               	c
IDENT               	thuscutlo
=                   	=
IDENT               	2
token(95)           	**
(                   	(
-                   	-
IDENT               	51
)                   	)
=                   	=
IDENT               	4
.                   	.
IDENT               	44089
IDENT               	e
-                   	-
IDENT               	16
IDENT               	c
IDENT               	cuthi
,                   	,
IDENT               	s
.                   	.
IDENT               	p
.                   	.
IDENT               	v
=                   	=
IDENT               	2
token(95)           	**
IDENT               	127
IDENT               	forunivac
,                   	,
IDENT               	honeywell
,                   	,
IDENT               	anddec
.                   	.
IDENT               	c
IDENT               	thuscuthi
=                   	=
IDENT               	2
token(95)           	**
(                   	(
IDENT               	63
.                   	.
IDENT               	5
)                   	)
=                   	=
IDENT               	1
.                   	.
IDENT               	30438
IDENT               	e19
IDENT               	c
IDENT               	cutlo
,                   	,
IDENT               	d
.                   	.
IDENT               	p
.                   	.
IDENT               	u
/                   	/
IDENT               	eps
=                   	=
IDENT               	2
token(95)           	**
(                   	(
-                   	-
IDENT               	67
)                   	)
IDENT               	forhoneywellanddec
.                   	.
IDENT               	c
IDENT               	thuscutlo
=                   	=
IDENT               	2
token(95)           	**
(                   	(
-                   	-
IDENT               	33
.                   	.
IDENT               	5
)                   	)
=                   	=
IDENT               	8
.                   	.
IDENT               	23181
IDENT               	d
-                   	-
IDENT               	11
IDENT               	c
IDENT               	cuthi
,                   	,
IDENT               	d
.                   	.
IDENT               	p
.                   	.
IDENT               	sameass
.                   	.
IDENT               	p
.                   	.
IDENT               	cuthi
=                   	=
IDENT               	1
.                   	.
IDENT               	30438
IDENT               	d19
IDENT               	c
IDENT               	datacutlo
,                   	,
IDENT               	cuthi
/                   	/
IDENT               	8
.                   	.
IDENT               	232
IDENT               	d
-                   	-
IDENT               	11
,                   	,
IDENT               	1
.                   	.
IDENT               	304
IDENT               	d19
/                   	/
IDENT               	c
IDENT               	datacutlo
,                   	,
IDENT               	cuthi
/                   	/
IDENT               	4
.                   	.
IDENT               	441
IDENT               	e
-                   	-
IDENT               	16
,                   	,
IDENT               	1
.                   	.
IDENT               	304
IDENT               	e19
/                   	/
IDENT               	datacutlo
,                   	,
IDENT               	cuthi
/                   	/
IDENT               	8
.                   	.
IDENT               	232
IDENT               	d
-                   	-
IDENT               	11
,                   	,
IDENT               	1
.                   	.
IDENT               	304
IDENT               	d19
/                   	/
IDENT               	c
if                  	if
(                   	(
IDENT               	n
.                   	.
IDENT               	gt
.                   	.
IDENT               	0
)                   	)
IDENT               	goto10
IDENT               	dnrm2
=                   	=
IDENT               	zero
IDENT               	goto300
IDENT               	c
IDENT               	10
IDENT               	assign30tonext
IDENT               	sum
=                   	=
IDENT               	zero
IDENT               	nn
=                   	=
IDENT               	n
*                   	*
IDENT               	incx
IDENT               	c
IDENT               	beginmainloop
IDENT               	i
=                   	=
IDENT               	1
IDENT               	20
IDENT               	gotonext
,                   	,
(                   	(
IDENT               	30
,                   	,
IDENT               	50
,                   	,
IDENT               	70
,                   	,
IDENT               	110
)                   	)
IDENT               	30
if                  	if
(                   	(
IDENT               	dabs
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
.                   	.
IDENT               	gt
.                   	.
IDENT               	cutlo
)                   	)
IDENT               	goto85
IDENT               	assign50tonext
IDENT               	xmax
=                   	=
IDENT               	zero
IDENT               	c
IDENT               	c
IDENT               	phase1
.                   	.
IDENT               	sumiszero
IDENT               	c
IDENT               	50
if                  	if
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
.                   	.
IDENT               	eq
.                   	.
IDENT               	zero
)                   	)
IDENT               	goto200
if                  	if
(                   	(
IDENT               	dabs
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
.                   	.
IDENT               	gt
.                   	.
IDENT               	cutlo
)                   	)
IDENT               	goto85
IDENT               	c
IDENT               	c
IDENT               	prepareforphase2
.                   	.
IDENT               	assign70tonext
IDENT               	goto105
IDENT               	c
IDENT               	c
IDENT               	prepareforphase4
.                   	.
IDENT               	c
IDENT               	100
IDENT               	i
=                   	=
IDENT               	j
IDENT               	assign110tonext
IDENT               	sum
=                   	=
(                   	(
IDENT               	sum
/                   	/
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
/                   	/
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
IDENT               	105
IDENT               	xmax
=                   	=
IDENT               	dabs
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
IDENT               	goto115
IDENT               	c
IDENT               	c
IDENT               	phase2
.                   	.
IDENT               	sumissmall
.                   	.
IDENT               	c
IDENT               	scaletoavoiddestructiveunderflow
.                   	.
IDENT               	c
IDENT               	70
if                  	if
(                   	(
IDENT               	dabs
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
.                   	.
IDENT               	gt
.                   	.
IDENT               	cutlo
)                   	)
IDENT               	goto75
IDENT               	c
IDENT               	c
IDENT               	commoncodeforphases2and4
.                   	.
IDENT               	c
IDENT               	inphase4sumislarge
.                   	.
IDENT               	scaletoavoidoverflow
.                   	.
IDENT               	c
IDENT               	110
if                  	if
(                   	(
IDENT               	dabs
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
.                   	.
IDENT               	le
.                   	.
IDENT               	xmax
)                   	)
IDENT               	goto115
IDENT               	sum
=                   	=
IDENT               	one
+                   	+
IDENT               	sum
*                   	*
(                   	(
IDENT               	xmax
/                   	/
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
token(95)           	**
IDENT               	2
IDENT               	xmax
=                   	=
IDENT               	dabs
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
)                   	)
IDENT               	goto200
IDENT               	c
IDENT               	115
IDENT               	sum
=                   	=
IDENT               	sum
+                   	+
(                   	(
IDENT               	dx
(                   	(
IDENT               	i
)                   	)
/                   	/
IDENT               	xmax
)                   	)
token(95)           	**
IDENT               	2
IDENT               	goto200
IDENT               	c
IDENT               	c
IDENT               	c
IDENT               	prepareforphase3
.                   	.
IDENT               	c
IDENT               	75
IDENT               	sum
=                   	=
(                   	(
IDENT               	sum
*                   	*
IDENT               	xmax
)                   	)
*                   	*
IDENT               	xmax
IDENT               	c
IDENT               	c
IDENT               	c
IDENT               	forrealord
.                   	.
IDENT               	p
.                   	.
IDENT               	sethitest
=                   	=
IDENT               	cuthi
/                   	/
IDENT               	n
IDENT               	c
IDENT               	forcomplexsethitest
=                   	=
IDENT               	cuthi
/                   	/
(                   	(
IDENT               	2
*                   	*
IDENT               	n
)                   	)
IDENT               	c
IDENT               	85
IDENT               	hitest
=                   	=
IDENT               	cuthi
/                   	/
IDENT               	float
(                   	(
IDENT               	n
)                   	)
IDENT               	c
IDENT               	c
IDENT               	phase3
.                   	.
IDENT               	sumismid
-                   	-
IDENT               	range
.                   	.
IDENT               	noscaling
.                   	.
IDENT               	c
IDENT               	do95j
=                   	=
IDENT               	i
,                   	,
IDENT               	nn
,                   	,
IDENT               	incx
if                  	if
(                   	(
IDENT               	dabs
(                   	(
IDENT               	dx
(                   	(
IDENT               	j
)                   	)
)                   	)
.                   	.
IDENT               	ge
.                   	.
IDENT               	hitest
)                   	)
IDENT               	goto100
IDENT               	95
IDENT               	sum
=                   	=
IDENT               	sum
+                   	+
IDENT               	dx
(                   	(
IDENT               	j
)                   	)
token(95)           	**
IDENT               	2
IDENT               	dnrm2
=                   	=
IDENT               	dsqrt
(                   	(
IDENT               	sum
)                   	)
IDENT               	goto300
IDENT               	c
IDENT               	200
IDENT               	continue
IDENT               	i
=                   	=
IDENT               	i
+                   	+
IDENT               	incx
if                  	if
(                   	(
IDENT               	i
.                   	.
IDENT               	le
.                   	.
IDENT               	nn
)                   	)
IDENT               	goto20
IDENT               	c
IDENT               	c
IDENT               	endofmainloop
.                   	.
IDENT               	c
IDENT               	c
IDENT               	computesquarerootandadjustforscaling
.                   	.
IDENT               	c
IDENT               	dnrm2
=                   	=
IDENT               	xmax
*                   	*
IDENT               	dsqrt
(                   	(
IDENT               	sum
)                   	)
IDENT               	300
IDENT               	continue
IDENT               	return
IDENT               	end
