COMMENT             	  Exerciser for recognition and flagging of various I/O keywords.
token(97)           	program
IDENT               	iokeywds
IDENT               	call
IDENT               	vms_isms
IDENT               	call
IDENT               	direct_access
IDENT               	call
IDENT               	f90_stuff
IDENT               	end
token(96)           	subroutine
IDENT               	vms_isms
IDENT               	character
*                   	*
IDENT               	512
IDENT               	line
(                   	(
IDENT               	4
)                   	)
COMMENT             	C  This one uses some VMS-isms
IDENT               	open
(                   	(
IDENT               	unit
=                   	=
IDENT               	1
,                   	,
IDENT               	carriagecontrol
=                   	=
STRING              	'none'
,                   	,
IDENT               	recordtype
=                   	=
STRING              	'fixed'
,                   	,
IDENT               	recl
=                   	=
IDENT               	2048
,                   	,
IDENT               	status
=                   	=
STRING              	'new'
,                   	,
IDENT               	name
=                   	=
STRING              	'file1'
)                   	)
IDENT               	open
(                   	(
IDENT               	unit
=                   	=
IDENT               	2
,                   	,
IDENT               	carriagecontrol
=                   	=
STRING              	'none'
,                   	,
IDENT               	recl
=                   	=
IDENT               	512
,                   	,
IDENT               	status
=                   	=
STRING              	'old'
,                   	,
IDENT               	err
=                   	=
IDENT               	1
)                   	)
IDENT               	goto
IDENT               	2
IDENT               	1
IDENT               	stop
STRING              	'Please $ASSIGN/USER output FOR001'
IDENT               	2
IDENT               	do
IDENT               	i
=                   	=
IDENT               	1
,                   	,
IDENT               	4
IDENT               	read
(                   	(
IDENT               	2
,                   	,
STRING              	'(a)'
,                   	,
IDENT               	err
=                   	=
IDENT               	3
)                   	)
IDENT               	line
(                   	(
IDENT               	i
)                   	)
IDENT               	end
IDENT               	do
IDENT               	write
(                   	(
IDENT               	1
,                   	,
STRING              	'(a)'
)                   	)
IDENT               	line
(                   	(
IDENT               	1
)                   	)
/                   	/
/                   	/
IDENT               	line
(                   	(
IDENT               	2
)                   	)
/                   	/
/                   	/
IDENT               	line
(                   	(
IDENT               	3
)                   	)
/                   	/
/                   	/
IDENT               	line
(                   	(
IDENT               	4
)                   	)
IDENT               	goto
IDENT               	2
IDENT               	3
IDENT               	continue
IDENT               	close
(                   	(
IDENT               	unit
=                   	=
IDENT               	1
)                   	)
IDENT               	close
(                   	(
IDENT               	unit
=                   	=
IDENT               	2
)                   	)
IDENT               	end
token(96)           	subroutine
IDENT               	direct_access
IDENT               	character
IDENT               	inline
*                   	*
IDENT               	79
IDENT               	open
(                   	(
IDENT               	unit
=                   	=
IDENT               	1
,                   	,
IDENT               	file
=                   	=
STRING              	'test'
,                   	,
IDENT               	access
=                   	=
STRING              	'direct'
,                   	,
IDENT               	form
=                   	=
STRING              	'formatted'
,                   	,
IDENT               	1
IDENT               	status
=                   	=
STRING              	'new'
,                   	,
IDENT               	recl
=                   	=
IDENT               	80
,                   	,
IDENT               	err
=                   	=
IDENT               	909
)                   	)
COMMENT             	*
COMMENT             	*       Read a line from standard input, write it to the new file,
COMMENT             	*       and echo it to standard output.
COMMENT             	*
IDENT               	do
IDENT               	j
=                   	=
IDENT               	1
,                   	,
IDENT               	100
IDENT               	read
(                   	(
IDENT               	5
,                   	,
IDENT               	10
,                   	,
IDENT               	end
=                   	=
IDENT               	910
)                   	)
IDENT               	inline
IDENT               	write
(                   	(
IDENT               	1
,                   	,
IDENT               	20
,                   	,
IDENT               	rec
=                   	=
IDENT               	j
)                   	)
IDENT               	inline
IDENT               	write
(                   	(
IDENT               	5
,                   	,
IDENT               	20
)                   	)
IDENT               	inline
IDENT               	enddo
IDENT               	10
IDENT               	format
(                   	(
IDENT               	79
IDENT               	a
)                   	)
IDENT               	20
IDENT               	format
(                   	(
IDENT               	1
IDENT               	x79a
)                   	)
IDENT               	GoTo
IDENT               	910
IDENT               	909
IDENT               	print
*                   	*
,                   	,
STRING              	'Error opening file.'
IDENT               	910
IDENT               	continue
IDENT               	close
(                   	(
IDENT               	unit
=                   	=
IDENT               	1
)                   	)
IDENT               	close
(                   	(
IDENT               	unit
=                   	=
IDENT               	5
)                   	)
IDENT               	end
token(96)           	subroutine
IDENT               	f90_stuff
token(98)           	integer
IDENT               	unit
,                   	,
IDENT               	inputsize
,                   	,
IDENT               	val
,                   	,
IDENT               	i1
IDENT               	character
*                   	*
IDENT               	20
IDENT               	c1
,                   	,
IDENT               	c2
IDENT               	unit
=                   	=
IDENT               	3
IDENT               	open
(                   	(
IDENT               	unit
=                   	=
IDENT               	unit
,                   	,
IDENT               	file
=                   	=
STRING              	'data.dat'
,                   	,
IDENT               	status
=                   	=
STRING              	'old'
,                   	,
IDENT               	action
=                   	=
STRING              	'read'
,                   	,
IDENT               	access
=                   	=
STRING              	'sequential'
,                   	,
IDENT               	form
=                   	=
STRING              	'formatted'
,                   	,
IDENT               	err
=                   	=
IDENT               	910
)                   	)
IDENT               	read
(                   	(
IDENT               	unit
=                   	=
IDENT               	unit
,                   	,
IDENT               	fmt
=                   	=
STRING              	'(i10)'
,                   	,
IDENT               	advance
=                   	=
STRING              	'no'
,                   	,
IDENT               	size
=                   	=
IDENT               	inputsize
,                   	,
IDENT               	err
=                   	=
IDENT               	920
)                   	)
IDENT               	val
IDENT               	inquire
(                   	(
IDENT               	unit
=                   	=
IDENT               	unit
,                   	,
IDENT               	recl
=                   	=
IDENT               	i1
,                   	,
IDENT               	access
=                   	=
IDENT               	c1
,                   	,
IDENT               	position
=                   	=
IDENT               	c2
)                   	)
IDENT               	write
(                   	(
IDENT               	unit
=                   	=
*                   	*
,                   	,
IDENT               	fmt
=                   	=
STRING              	'(1x,a7)'
,                   	,
IDENT               	advance
=                   	=
STRING              	'yes'
)                   	)
STRING              	'Success'
IDENT               	close
(                   	(
IDENT               	unit
)                   	)
IDENT               	return
IDENT               	910
IDENT               	print
*                   	*
,                   	,
STRING              	'Error opening file.'
IDENT               	return
IDENT               	920
IDENT               	print
*                   	*
,                   	,
STRING              	'Error reading file.'
IDENT               	return
IDENT               	end
