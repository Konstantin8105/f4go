COMMENT             	C  Exerciser for recognition and flagging of various I/O keywords.
token(97)           	program
IDENT               	iokeywds
token(105)          	call
IDENT               	vms_isms
token(105)          	call
IDENT               	direct_access
token(105)          	call
IDENT               	f90_stuff
token(102)          	end
token(96)           	subroutine
IDENT               	vms_isms
IDENT               	character
*                   	*
INT                 	512
IDENT               	line
(                   	(
INT                 	4
)                   	)
COMMENT             	C  This one uses some VMS-isms
IDENT               	open
(                   	(
IDENT               	unit
=                   	=
INT                 	1
,                   	,
IDENT               	carriagecontrol
=                   	=
STRING              	'none'
,                   	,
IDENT               	recordtype
=                   	=
STRING              	'fixed'
,                   	,
IDENT               	recl
=                   	=
INT                 	2048
,                   	,
IDENT               	status
=                   	=
STRING              	'new'
,                   	,
IDENT               	name
=                   	=
STRING              	'file1'
)                   	)
IDENT               	open
(                   	(
IDENT               	unit
=                   	=
INT                 	2
,                   	,
IDENT               	carriagecontrol
=                   	=
STRING              	'none'
,                   	,
IDENT               	recl
=                   	=
INT                 	512
,                   	,
IDENT               	status
=                   	=
STRING              	'old'
,                   	,
IDENT               	err
=                   	=
INT                 	1
)                   	)
IDENT               	goto
INT                 	2
INT                 	1
IDENT               	stop
STRING              	'Please $ASSIGN/USER output FOR001'
INT                 	2
token(103)          	do
IDENT               	i
=                   	=
INT                 	1
,                   	,
INT                 	4
IDENT               	read
(                   	(
INT                 	2
,                   	,
STRING              	'(a)'
,                   	,
IDENT               	err
=                   	=
INT                 	3
)                   	)
IDENT               	line
(                   	(
IDENT               	i
)                   	)
token(102)          	end
token(103)          	do
IDENT               	write
(                   	(
INT                 	1
,                   	,
STRING              	'(a)'
)                   	)
IDENT               	line
(                   	(
INT                 	1
)                   	)
/                   	/
/                   	/
IDENT               	line
(                   	(
INT                 	2
)                   	)
/                   	/
/                   	/
IDENT               	line
(                   	(
INT                 	3
)                   	)
/                   	/
/                   	/
IDENT               	line
(                   	(
INT                 	4
)                   	)
IDENT               	goto
INT                 	2
INT                 	3
continue            	continue
IDENT               	close
(                   	(
IDENT               	unit
=                   	=
INT                 	1
)                   	)
IDENT               	close
(                   	(
IDENT               	unit
=                   	=
INT                 	2
)                   	)
token(102)          	end
token(96)           	subroutine
IDENT               	direct_access
IDENT               	character
IDENT               	inline
*                   	*
INT                 	79
IDENT               	open
(                   	(
IDENT               	unit
=                   	=
INT                 	1
,                   	,
IDENT               	file
=                   	=
STRING              	'test'
,                   	,
IDENT               	access
=                   	=
STRING              	'direct'
,                   	,
IDENT               	form
=                   	=
STRING              	'formatted'
,                   	,
INT                 	1
IDENT               	status
=                   	=
STRING              	'new'
,                   	,
IDENT               	recl
=                   	=
INT                 	80
,                   	,
IDENT               	err
=                   	=
INT                 	909
)                   	)
COMMENT             	*
COMMENT             	*       Read a line from standard input, write it to the new file,
COMMENT             	*       and echo it to standard output.
COMMENT             	*
token(103)          	do
IDENT               	j
=                   	=
INT                 	1
,                   	,
INT                 	100
IDENT               	read
(                   	(
INT                 	5
,                   	,
INT                 	10
,                   	,
token(102)          	end
=                   	=
INT                 	910
)                   	)
IDENT               	inline
IDENT               	write
(                   	(
INT                 	1
,                   	,
INT                 	20
,                   	,
IDENT               	rec
=                   	=
IDENT               	j
)                   	)
IDENT               	inline
IDENT               	write
(                   	(
INT                 	5
,                   	,
INT                 	20
)                   	)
IDENT               	inline
token(104)          	enddo
INT                 	10
IDENT               	format
(                   	(
INT                 	79
IDENT               	a
)                   	)
INT                 	20
IDENT               	format
(                   	(
INT                 	1
IDENT               	x79a
)                   	)
IDENT               	GoTo
INT                 	910
INT                 	909
IDENT               	print
*                   	*
,                   	,
STRING              	'Error opening file.'
INT                 	910
continue            	continue
IDENT               	close
(                   	(
IDENT               	unit
=                   	=
INT                 	1
)                   	)
IDENT               	close
(                   	(
IDENT               	unit
=                   	=
INT                 	5
)                   	)
token(102)          	end
token(96)           	subroutine
IDENT               	f90_stuff
token(98)           	integer
IDENT               	unit
,                   	,
IDENT               	inputsize
,                   	,
IDENT               	val
,                   	,
IDENT               	i1
IDENT               	character
*                   	*
INT                 	20
IDENT               	c1
,                   	,
IDENT               	c2
IDENT               	unit
=                   	=
INT                 	3
IDENT               	open
(                   	(
IDENT               	unit
=                   	=
IDENT               	unit
,                   	,
IDENT               	file
=                   	=
STRING              	'data.dat'
,                   	,
IDENT               	status
=                   	=
STRING              	'old'
,                   	,
IDENT               	action
=                   	=
STRING              	'read'
,                   	,
IDENT               	access
=                   	=
STRING              	'sequential'
,                   	,
IDENT               	form
=                   	=
STRING              	'formatted'
,                   	,
IDENT               	err
=                   	=
INT                 	910
)                   	)
IDENT               	read
(                   	(
IDENT               	unit
=                   	=
IDENT               	unit
,                   	,
IDENT               	fmt
=                   	=
STRING              	'(i10)'
,                   	,
IDENT               	advance
=                   	=
STRING              	'no'
,                   	,
IDENT               	size
=                   	=
IDENT               	inputsize
,                   	,
IDENT               	err
=                   	=
INT                 	920
)                   	)
IDENT               	val
IDENT               	inquire
(                   	(
IDENT               	unit
=                   	=
IDENT               	unit
,                   	,
IDENT               	recl
=                   	=
IDENT               	i1
,                   	,
IDENT               	access
=                   	=
IDENT               	c1
,                   	,
IDENT               	position
=                   	=
IDENT               	c2
)                   	)
IDENT               	write
(                   	(
IDENT               	unit
=                   	=
*                   	*
,                   	,
IDENT               	fmt
=                   	=
STRING              	'(1x,a7)'
,                   	,
IDENT               	advance
=                   	=
STRING              	'yes'
)                   	)
STRING              	'Success'
IDENT               	close
(                   	(
IDENT               	unit
)                   	)
IDENT               	return
INT                 	910
IDENT               	print
*                   	*
,                   	,
STRING              	'Error opening file.'
IDENT               	return
INT                 	920
IDENT               	print
*                   	*
,                   	,
STRING              	'Error reading file.'
IDENT               	return
token(102)          	end
