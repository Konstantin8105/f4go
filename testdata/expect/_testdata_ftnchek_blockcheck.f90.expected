token(97)           	program
IDENT               	blocks
COMMENT             	! program to check parsing of block structures
IDENT               	real
IDENT               	x
token(98)           	integer
IDENT               	n
IDENT               	x
=                   	=
IDENT               	bar
(                   	(
IDENT               	1
.                   	.
IDENT               	0
)                   	)
if                  	if
(                   	(
IDENT               	x
.                   	.
IDENT               	gt
.                   	.
IDENT               	0
)                   	)
IDENT               	then
IDENT               	call
IDENT               	baz
(                   	(
IDENT               	x
)                   	)
IDENT               	n
=                   	=
IDENT               	int
(                   	(
IDENT               	x
)                   	)
IDENT               	select
IDENT               	case
(                   	(
IDENT               	n
)                   	)
IDENT               	case
(                   	(
IDENT               	1
)                   	)
IDENT               	call
IDENT               	baz
(                   	(
IDENT               	2
.                   	.
IDENT               	0
)                   	)
IDENT               	case
(                   	(
IDENT               	2
:                   	:
IDENT               	10
)                   	)
IDENT               	call
IDENT               	baz
(                   	(
IDENT               	3
.                   	.
IDENT               	0
)                   	)
IDENT               	case
(                   	(
-                   	-
IDENT               	1
,                   	,
IDENT               	11
:                   	:
IDENT               	100
,                   	,
IDENT               	300
)                   	)
IDENT               	call
IDENT               	baz
(                   	(
IDENT               	4
.                   	.
IDENT               	0
)                   	)
IDENT               	case
IDENT               	default
IDENT               	call
IDENT               	baz
(                   	(
IDENT               	5
.                   	.
IDENT               	0
)                   	)
token(102)          	end
IDENT               	select
else                	else
IDENT               	k
=                   	=
IDENT               	0
IDENT               	loop1
:                   	:
token(103)          	do
IDENT               	i
=                   	=
IDENT               	1
,                   	,
IDENT               	100
IDENT               	loop2
:                   	:
token(103)          	do
IDENT               	j
=                   	=
IDENT               	1
,                   	,
IDENT               	10
IDENT               	write
(                   	(
*                   	*
,                   	,
*                   	*
)                   	)
IDENT               	i
,                   	,
IDENT               	j
,                   	,
IDENT               	i
*                   	*
IDENT               	j
if                  	if
(                   	(
IDENT               	i
.                   	.
IDENT               	eq
.                   	.
IDENT               	50
)                   	)
IDENT               	exit
IDENT               	loop1
IDENT               	k
=                   	=
IDENT               	k
+                   	+
IDENT               	j
if                  	if
(                   	(
IDENT               	k
.                   	.
IDENT               	eq
.                   	.
IDENT               	50
)                   	)
IDENT               	cycle
IDENT               	loop2
token(102)          	end
token(103)          	do
IDENT               	loop2
IDENT               	write
(                   	(
*                   	*
,                   	,
*                   	*
)                   	)
IDENT               	k
*                   	*
IDENT               	i
token(95)           	**
IDENT               	2
token(104)          	enddo
IDENT               	loop1
IDENT               	case2
:                   	:
IDENT               	select
IDENT               	case
(                   	(
IDENT               	n
)                   	)
IDENT               	case
(                   	(
IDENT               	1
)                   	)
IDENT               	case2
IDENT               	call
IDENT               	baz
(                   	(
IDENT               	2
.                   	.
IDENT               	0
)                   	)
IDENT               	case
(                   	(
IDENT               	2
:                   	:
IDENT               	10
)                   	)
IDENT               	case2
IDENT               	call
IDENT               	baz
(                   	(
IDENT               	3
.                   	.
IDENT               	0
)                   	)
IDENT               	case
(                   	(
-                   	-
IDENT               	1
,                   	,
IDENT               	11
:                   	:
IDENT               	100
,                   	,
IDENT               	300
)                   	)
IDENT               	case2
IDENT               	call
IDENT               	baz
(                   	(
IDENT               	4
.                   	.
IDENT               	0
)                   	)
IDENT               	case
IDENT               	default
IDENT               	case2
token(103)          	do
IDENT               	i
=                   	=
IDENT               	1
,                   	,
IDENT               	10
if                  	if
(                   	(
IDENT               	i
=                   	=
=                   	=
IDENT               	7
)                   	)
IDENT               	goto
IDENT               	200
IDENT               	call
IDENT               	baz
(                   	(
IDENT               	5
.                   	.
IDENT               	0
)                   	)
IDENT               	200
token(102)          	end
token(103)          	do
token(102)          	end
IDENT               	select
IDENT               	case2
token(102)          	end
if                  	if
token(102)          	end
token(97)           	program
IDENT               	blocks
token(101)          	function
IDENT               	bar
(                   	(
IDENT               	c
)                   	)
IDENT               	real
IDENT               	a
,                   	,
IDENT               	b
,                   	,
IDENT               	c
,                   	,
IDENT               	d
IDENT               	read
*                   	*
,                   	,
IDENT               	a
COMMENT             	! This block is from section 8.1.2.3 of the F90 standard, except for
COMMENT             	! removing space between some keywords
if                  	if
(                   	(
IDENT               	a
.                   	.
IDENT               	gt
.                   	.
IDENT               	0
)                   	)
IDENT               	then
IDENT               	b
=                   	=
IDENT               	c
/                   	/
IDENT               	a
if                  	if
(                   	(
IDENT               	b
.                   	.
IDENT               	gt
.                   	.
IDENT               	0
)                   	)
IDENT               	then
IDENT               	d
=                   	=
IDENT               	1
.                   	.
IDENT               	0
IDENT               	endif
IDENT               	elseif
(                   	(
IDENT               	c
.                   	.
IDENT               	gt
.                   	.
IDENT               	0
)                   	)
IDENT               	then
IDENT               	b
=                   	=
IDENT               	a
/                   	/
IDENT               	c
IDENT               	d
=                   	=
-                   	-
IDENT               	1
.                   	.
IDENT               	0
else                	else
IDENT               	b
=                   	=
IDENT               	abs
(                   	(
IDENT               	max
(                   	(
IDENT               	a
,                   	,
IDENT               	c
)                   	)
)                   	)
IDENT               	d
=                   	=
IDENT               	0
IDENT               	endif
IDENT               	bar
=                   	=
IDENT               	d
*                   	*
IDENT               	b
token(102)          	end
token(101)          	function
IDENT               	bar
token(96)           	subroutine
IDENT               	baz
(                   	(
IDENT               	c
)                   	)
IDENT               	real
IDENT               	a
,                   	,
IDENT               	b
,                   	,
IDENT               	c
,                   	,
IDENT               	d
IDENT               	read
*                   	*
,                   	,
IDENT               	a
COMMENT             	! Same as above but with spaces restored and construct names added
IDENT               	first_if
:                   	:
if                  	if
(                   	(
IDENT               	a
.                   	.
IDENT               	gt
.                   	.
IDENT               	0
)                   	)
IDENT               	then
IDENT               	b
=                   	=
IDENT               	c
/                   	/
IDENT               	a
IDENT               	second_if
:                   	:
if                  	if
(                   	(
IDENT               	b
.                   	.
IDENT               	gt
.                   	.
IDENT               	0
)                   	)
IDENT               	then
IDENT               	d
=                   	=
IDENT               	1
.                   	.
IDENT               	0
token(102)          	end
if                  	if
IDENT               	second_if
else                	else
if                  	if
(                   	(
IDENT               	c
.                   	.
IDENT               	gt
.                   	.
IDENT               	0
)                   	)
IDENT               	then
IDENT               	first_if
IDENT               	b
=                   	=
IDENT               	a
/                   	/
IDENT               	c
IDENT               	d
=                   	=
-                   	-
IDENT               	1
.                   	.
IDENT               	0
else                	else
IDENT               	first_if
IDENT               	b
=                   	=
IDENT               	abs
(                   	(
IDENT               	max
(                   	(
IDENT               	a
,                   	,
IDENT               	c
)                   	)
)                   	)
IDENT               	d
=                   	=
IDENT               	0
token(102)          	end
if                  	if
IDENT               	first_if
IDENT               	print
*                   	*
,                   	,
IDENT               	a
,                   	,
IDENT               	b
,                   	,
IDENT               	c
,                   	,
IDENT               	d
token(102)          	end
token(96)           	subroutine
IDENT               	baz
